var gr=Object.defineProperty;var br=(t,s,r)=>s in t?gr(t,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[s]=r;var Ke=(t,s,r)=>br(t,typeof s!="symbol"?s+"":s,r);import{j as e,L as es,T as ts,C as ss,R as wr,a as rs,b as as,I as vr,c as os,d as yr,e as ns,f as is,g as jr,O as ls,P as Nr,h as cs,i as kr,k as ds,D as us,l as Cr,m as ps,V as Sr,n as Rr,S as ms,o as Er,p as hs,q as fs,r as Pr,s as xs,t as gs,u as bs,v as ws,w as vs,x as ys,y as js,z as Tr,A as Lr,B as Ns,E as ks,F as Cs,G as Ss,H as Rs,J as Es,K as $r}from"./radix-vendor.js";import{b as Mr,r as i,R as zr}from"./react-vendor.js";import{C as Ps,a as Ts,X as Mt,L as ie,G as Ls,P as Ar,b as Fr,c as zt,A as nt,M as gt,S as Ur,d as _r,e as Ee,F as xe,f as Ir,g as Or,E as $s,h as ne,D as Ms,i as Wt,T as Re,j as yt,k as Qe,l as Dr,m as zs,n as jt,o as Br,J as Xe,B as Gr,p as Wr,q as Jr,r as Vr,s as Hr,t as Zr,R as qr}from"./utils-vendor.js";import{m as At}from"./markdown-vendor.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))a(n);new MutationObserver(n=>{for(const c of n)if(c.type==="childList")for(const h of c.addedNodes)h.tagName==="LINK"&&h.rel==="modulepreload"&&a(h)}).observe(document,{childList:!0,subtree:!0});function r(n){const c={};return n.integrity&&(c.integrity=n.integrity),n.referrerPolicy&&(c.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?c.credentials="include":n.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function a(n){if(n.ep)return;n.ep=!0;const c=r(n);fetch(n.href,c)}})();var Nt={},Jt=Mr;Nt.createRoot=Jt.createRoot,Nt.hydrateRoot=Jt.hydrateRoot;function As(t){var s,r,a="";if(typeof t=="string"||typeof t=="number")a+=t;else if(typeof t=="object")if(Array.isArray(t)){var n=t.length;for(s=0;s<n;s++)t[s]&&(r=As(t[s]))&&(a&&(a+=" "),a+=r)}else for(r in t)t[r]&&(a&&(a+=" "),a+=r);return a}function Fs(){for(var t,s,r=0,a="",n=arguments.length;r<n;r++)(t=arguments[r])&&(s=As(t))&&(a&&(a+=" "),a+=s);return a}const Ft="-",Kr=t=>{const s=Xr(t),{conflictingClassGroups:r,conflictingClassGroupModifiers:a}=t;return{getClassGroupId:h=>{const f=h.split(Ft);return f[0]===""&&f.length!==1&&f.shift(),Us(f,s)||Qr(h)},getConflictingClassGroupIds:(h,f)=>{const w=r[h]||[];return f&&a[h]?[...w,...a[h]]:w}}},Us=(t,s)=>{var h;if(t.length===0)return s.classGroupId;const r=t[0],a=s.nextPart.get(r),n=a?Us(t.slice(1),a):void 0;if(n)return n;if(s.validators.length===0)return;const c=t.join(Ft);return(h=s.validators.find(({validator:f})=>f(c)))==null?void 0:h.classGroupId},Vt=/^\[(.+)\]$/,Qr=t=>{if(Vt.test(t)){const s=Vt.exec(t)[1],r=s==null?void 0:s.substring(0,s.indexOf(":"));if(r)return"arbitrary.."+r}},Xr=t=>{const{theme:s,prefix:r}=t,a={nextPart:new Map,validators:[]};return ea(Object.entries(t.classGroups),r).forEach(([c,h])=>{kt(h,a,c,s)}),a},kt=(t,s,r,a)=>{t.forEach(n=>{if(typeof n=="string"){const c=n===""?s:Ht(s,n);c.classGroupId=r;return}if(typeof n=="function"){if(Yr(n)){kt(n(a),s,r,a);return}s.validators.push({validator:n,classGroupId:r});return}Object.entries(n).forEach(([c,h])=>{kt(h,Ht(s,c),r,a)})})},Ht=(t,s)=>{let r=t;return s.split(Ft).forEach(a=>{r.nextPart.has(a)||r.nextPart.set(a,{nextPart:new Map,validators:[]}),r=r.nextPart.get(a)}),r},Yr=t=>t.isThemeGetter,ea=(t,s)=>s?t.map(([r,a])=>{const n=a.map(c=>typeof c=="string"?s+c:typeof c=="object"?Object.fromEntries(Object.entries(c).map(([h,f])=>[s+h,f])):c);return[r,n]}):t,ta=t=>{if(t<1)return{get:()=>{},set:()=>{}};let s=0,r=new Map,a=new Map;const n=(c,h)=>{r.set(c,h),s++,s>t&&(s=0,a=r,r=new Map)};return{get(c){let h=r.get(c);if(h!==void 0)return h;if((h=a.get(c))!==void 0)return n(c,h),h},set(c,h){r.has(c)?r.set(c,h):n(c,h)}}},_s="!",sa=t=>{const{separator:s,experimentalParseClassName:r}=t,a=s.length===1,n=s[0],c=s.length,h=f=>{const w=[];let l=0,m=0,v;for(let p=0;p<f.length;p++){let $=f[p];if(l===0){if($===n&&(a||f.slice(p,p+c)===s)){w.push(f.slice(m,p)),m=p+c;continue}if($==="/"){v=p;continue}}$==="["?l++:$==="]"&&l--}const d=w.length===0?f:f.substring(m),A=d.startsWith(_s),P=A?d.substring(1):d,k=v&&v>m?v-m:void 0;return{modifiers:w,hasImportantModifier:A,baseClassName:P,maybePostfixModifierPosition:k}};return r?f=>r({className:f,parseClassName:h}):h},ra=t=>{if(t.length<=1)return t;const s=[];let r=[];return t.forEach(a=>{a[0]==="["?(s.push(...r.sort(),a),r=[]):r.push(a)}),s.push(...r.sort()),s},aa=t=>({cache:ta(t.cacheSize),parseClassName:sa(t),...Kr(t)}),oa=/\s+/,na=(t,s)=>{const{parseClassName:r,getClassGroupId:a,getConflictingClassGroupIds:n}=s,c=[],h=t.trim().split(oa);let f="";for(let w=h.length-1;w>=0;w-=1){const l=h[w],{modifiers:m,hasImportantModifier:v,baseClassName:d,maybePostfixModifierPosition:A}=r(l);let P=!!A,k=a(P?d.substring(0,A):d);if(!k){if(!P){f=l+(f.length>0?" "+f:f);continue}if(k=a(d),!k){f=l+(f.length>0?" "+f:f);continue}P=!1}const p=ra(m).join(":"),$=v?p+_s:p,T=$+k;if(c.includes(T))continue;c.push(T);const J=n(k,P);for(let U=0;U<J.length;++U){const Y=J[U];c.push($+Y)}f=l+(f.length>0?" "+f:f)}return f};function ia(){let t=0,s,r,a="";for(;t<arguments.length;)(s=arguments[t++])&&(r=Is(s))&&(a&&(a+=" "),a+=r);return a}const Is=t=>{if(typeof t=="string")return t;let s,r="";for(let a=0;a<t.length;a++)t[a]&&(s=Is(t[a]))&&(r&&(r+=" "),r+=s);return r};function la(t,...s){let r,a,n,c=h;function h(w){const l=s.reduce((m,v)=>v(m),t());return r=aa(l),a=r.cache.get,n=r.cache.set,c=f,f(w)}function f(w){const l=a(w);if(l)return l;const m=na(w,r);return n(w,m),m}return function(){return c(ia.apply(null,arguments))}}const D=t=>{const s=r=>r[t]||[];return s.isThemeGetter=!0,s},Os=/^\[(?:([a-z-]+):)?(.+)\]$/i,ca=/^\d+\/\d+$/,da=new Set(["px","full","screen"]),ua=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,pa=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,ma=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,ha=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,fa=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,oe=t=>Te(t)||da.has(t)||ca.test(t),he=t=>$e(t,"length",Na),Te=t=>!!t&&!Number.isNaN(Number(t)),bt=t=>$e(t,"number",Te),_e=t=>!!t&&Number.isInteger(Number(t)),xa=t=>t.endsWith("%")&&Te(t.slice(0,-1)),E=t=>Os.test(t),fe=t=>ua.test(t),ga=new Set(["length","size","percentage"]),ba=t=>$e(t,ga,Ds),wa=t=>$e(t,"position",Ds),va=new Set(["image","url"]),ya=t=>$e(t,va,Ca),ja=t=>$e(t,"",ka),Ie=()=>!0,$e=(t,s,r)=>{const a=Os.exec(t);return a?a[1]?typeof s=="string"?a[1]===s:s.has(a[1]):r(a[2]):!1},Na=t=>pa.test(t)&&!ma.test(t),Ds=()=>!1,ka=t=>ha.test(t),Ca=t=>fa.test(t),Sa=()=>{const t=D("colors"),s=D("spacing"),r=D("blur"),a=D("brightness"),n=D("borderColor"),c=D("borderRadius"),h=D("borderSpacing"),f=D("borderWidth"),w=D("contrast"),l=D("grayscale"),m=D("hueRotate"),v=D("invert"),d=D("gap"),A=D("gradientColorStops"),P=D("gradientColorStopPositions"),k=D("inset"),p=D("margin"),$=D("opacity"),T=D("padding"),J=D("saturate"),U=D("scale"),Y=D("sepia"),K=D("skew"),de=D("space"),g=D("translate"),R=()=>["auto","contain","none"],x=()=>["auto","hidden","clip","visible","scroll"],M=()=>["auto",E,s],C=()=>[E,s],_=()=>["",oe,he],O=()=>["auto",Te,E],W=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],ee=()=>["solid","dashed","dotted","double","none"],ue=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],pe=()=>["start","end","center","between","around","evenly","stretch"],B=()=>["","0",E],re=()=>["auto","avoid","all","avoid-page","page","left","right","column"],H=()=>[Te,E];return{cacheSize:500,separator:":",theme:{colors:[Ie],spacing:[oe,he],blur:["none","",fe,E],brightness:H(),borderColor:[t],borderRadius:["none","","full",fe,E],borderSpacing:C(),borderWidth:_(),contrast:H(),grayscale:B(),hueRotate:H(),invert:B(),gap:C(),gradientColorStops:[t],gradientColorStopPositions:[xa,he],inset:M(),margin:M(),opacity:H(),padding:C(),saturate:H(),scale:H(),sepia:B(),skew:H(),space:C(),translate:C()},classGroups:{aspect:[{aspect:["auto","square","video",E]}],container:["container"],columns:[{columns:[fe]}],"break-after":[{"break-after":re()}],"break-before":[{"break-before":re()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...W(),E]}],overflow:[{overflow:x()}],"overflow-x":[{"overflow-x":x()}],"overflow-y":[{"overflow-y":x()}],overscroll:[{overscroll:R()}],"overscroll-x":[{"overscroll-x":R()}],"overscroll-y":[{"overscroll-y":R()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[k]}],"inset-x":[{"inset-x":[k]}],"inset-y":[{"inset-y":[k]}],start:[{start:[k]}],end:[{end:[k]}],top:[{top:[k]}],right:[{right:[k]}],bottom:[{bottom:[k]}],left:[{left:[k]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",_e,E]}],basis:[{basis:M()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",E]}],grow:[{grow:B()}],shrink:[{shrink:B()}],order:[{order:["first","last","none",_e,E]}],"grid-cols":[{"grid-cols":[Ie]}],"col-start-end":[{col:["auto",{span:["full",_e,E]},E]}],"col-start":[{"col-start":O()}],"col-end":[{"col-end":O()}],"grid-rows":[{"grid-rows":[Ie]}],"row-start-end":[{row:["auto",{span:[_e,E]},E]}],"row-start":[{"row-start":O()}],"row-end":[{"row-end":O()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",E]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",E]}],gap:[{gap:[d]}],"gap-x":[{"gap-x":[d]}],"gap-y":[{"gap-y":[d]}],"justify-content":[{justify:["normal",...pe()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...pe(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...pe(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[T]}],px:[{px:[T]}],py:[{py:[T]}],ps:[{ps:[T]}],pe:[{pe:[T]}],pt:[{pt:[T]}],pr:[{pr:[T]}],pb:[{pb:[T]}],pl:[{pl:[T]}],m:[{m:[p]}],mx:[{mx:[p]}],my:[{my:[p]}],ms:[{ms:[p]}],me:[{me:[p]}],mt:[{mt:[p]}],mr:[{mr:[p]}],mb:[{mb:[p]}],ml:[{ml:[p]}],"space-x":[{"space-x":[de]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[de]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",E,s]}],"min-w":[{"min-w":[E,s,"min","max","fit"]}],"max-w":[{"max-w":[E,s,"none","full","min","max","fit","prose",{screen:[fe]},fe]}],h:[{h:[E,s,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[E,s,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[E,s,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[E,s,"auto","min","max","fit"]}],"font-size":[{text:["base",fe,he]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",bt]}],"font-family":[{font:[Ie]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",E]}],"line-clamp":[{"line-clamp":["none",Te,bt]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",oe,E]}],"list-image":[{"list-image":["none",E]}],"list-style-type":[{list:["none","disc","decimal",E]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[$]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[$]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...ee(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",oe,he]}],"underline-offset":[{"underline-offset":["auto",oe,E]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:C()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",E]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",E]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[$]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...W(),wa]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",ba]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},ya]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[P]}],"gradient-via-pos":[{via:[P]}],"gradient-to-pos":[{to:[P]}],"gradient-from":[{from:[A]}],"gradient-via":[{via:[A]}],"gradient-to":[{to:[A]}],rounded:[{rounded:[c]}],"rounded-s":[{"rounded-s":[c]}],"rounded-e":[{"rounded-e":[c]}],"rounded-t":[{"rounded-t":[c]}],"rounded-r":[{"rounded-r":[c]}],"rounded-b":[{"rounded-b":[c]}],"rounded-l":[{"rounded-l":[c]}],"rounded-ss":[{"rounded-ss":[c]}],"rounded-se":[{"rounded-se":[c]}],"rounded-ee":[{"rounded-ee":[c]}],"rounded-es":[{"rounded-es":[c]}],"rounded-tl":[{"rounded-tl":[c]}],"rounded-tr":[{"rounded-tr":[c]}],"rounded-br":[{"rounded-br":[c]}],"rounded-bl":[{"rounded-bl":[c]}],"border-w":[{border:[f]}],"border-w-x":[{"border-x":[f]}],"border-w-y":[{"border-y":[f]}],"border-w-s":[{"border-s":[f]}],"border-w-e":[{"border-e":[f]}],"border-w-t":[{"border-t":[f]}],"border-w-r":[{"border-r":[f]}],"border-w-b":[{"border-b":[f]}],"border-w-l":[{"border-l":[f]}],"border-opacity":[{"border-opacity":[$]}],"border-style":[{border:[...ee(),"hidden"]}],"divide-x":[{"divide-x":[f]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[f]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[$]}],"divide-style":[{divide:ee()}],"border-color":[{border:[n]}],"border-color-x":[{"border-x":[n]}],"border-color-y":[{"border-y":[n]}],"border-color-s":[{"border-s":[n]}],"border-color-e":[{"border-e":[n]}],"border-color-t":[{"border-t":[n]}],"border-color-r":[{"border-r":[n]}],"border-color-b":[{"border-b":[n]}],"border-color-l":[{"border-l":[n]}],"divide-color":[{divide:[n]}],"outline-style":[{outline:["",...ee()]}],"outline-offset":[{"outline-offset":[oe,E]}],"outline-w":[{outline:[oe,he]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:_()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[$]}],"ring-offset-w":[{"ring-offset":[oe,he]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",fe,ja]}],"shadow-color":[{shadow:[Ie]}],opacity:[{opacity:[$]}],"mix-blend":[{"mix-blend":[...ue(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":ue()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[a]}],contrast:[{contrast:[w]}],"drop-shadow":[{"drop-shadow":["","none",fe,E]}],grayscale:[{grayscale:[l]}],"hue-rotate":[{"hue-rotate":[m]}],invert:[{invert:[v]}],saturate:[{saturate:[J]}],sepia:[{sepia:[Y]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[a]}],"backdrop-contrast":[{"backdrop-contrast":[w]}],"backdrop-grayscale":[{"backdrop-grayscale":[l]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[m]}],"backdrop-invert":[{"backdrop-invert":[v]}],"backdrop-opacity":[{"backdrop-opacity":[$]}],"backdrop-saturate":[{"backdrop-saturate":[J]}],"backdrop-sepia":[{"backdrop-sepia":[Y]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[h]}],"border-spacing-x":[{"border-spacing-x":[h]}],"border-spacing-y":[{"border-spacing-y":[h]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",E]}],duration:[{duration:H()}],ease:[{ease:["linear","in","out","in-out",E]}],delay:[{delay:H()}],animate:[{animate:["none","spin","ping","pulse","bounce",E]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[U]}],"scale-x":[{"scale-x":[U]}],"scale-y":[{"scale-y":[U]}],rotate:[{rotate:[_e,E]}],"translate-x":[{"translate-x":[g]}],"translate-y":[{"translate-y":[g]}],"skew-x":[{"skew-x":[K]}],"skew-y":[{"skew-y":[K]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",E]}],accent:[{accent:["auto",t]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",E]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":C()}],"scroll-mx":[{"scroll-mx":C()}],"scroll-my":[{"scroll-my":C()}],"scroll-ms":[{"scroll-ms":C()}],"scroll-me":[{"scroll-me":C()}],"scroll-mt":[{"scroll-mt":C()}],"scroll-mr":[{"scroll-mr":C()}],"scroll-mb":[{"scroll-mb":C()}],"scroll-ml":[{"scroll-ml":C()}],"scroll-p":[{"scroll-p":C()}],"scroll-px":[{"scroll-px":C()}],"scroll-py":[{"scroll-py":C()}],"scroll-ps":[{"scroll-ps":C()}],"scroll-pe":[{"scroll-pe":C()}],"scroll-pt":[{"scroll-pt":C()}],"scroll-pr":[{"scroll-pr":C()}],"scroll-pb":[{"scroll-pb":C()}],"scroll-pl":[{"scroll-pl":C()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",E]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[oe,he,bt]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},Ra=la(Sa);function N(...t){return Ra(Fs(t))}const Ea=wr,Bs=i.forwardRef(({className:t,...s},r)=>e.jsx(es,{ref:r,className:N("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",t),...s}));Bs.displayName=es.displayName;const Ct=i.forwardRef(({className:t,...s},r)=>e.jsx(ts,{ref:r,className:N("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",t),...s}));Ct.displayName=ts.displayName;const St=i.forwardRef(({className:t,...s},r)=>e.jsx(ss,{ref:r,className:N("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...s}));St.displayName=ss.displayName;async function Q(t,s){return new Promise((r,a)=>{if(!navigator.serviceWorker.controller){a(new Error("Service worker not available"));return}const n=new MessageChannel;n.port1.onmessage=c=>{c.data.type==="RESPONSE"&&(c.data.data.error?a(new Error(c.data.data.error)):r(c.data.data))},navigator.serviceWorker.controller.postMessage({type:t,data:s},[n.port2]),setTimeout(()=>{a(new Error("Service worker request timeout"))},3e4)})}function Pa(t){const s=r=>{r.data.type==="CRAWL_PROGRESS"&&t(r.data.data)};return navigator.serviceWorker.addEventListener("message",s),()=>{navigator.serviceWorker.removeEventListener("message",s)}}const te={async startCrawl(t,s){return Q("START_CRAWL",{baseUrl:t,options:s})},async cancelCrawl(){return Q("CANCEL_CRAWL")},async getJobs(){return(await Q("GET_JOBS")).jobs||[]},async getJob(t){return(await Q("GET_JOB",{jobId:t})).job},async deleteJob(t){return Q("DELETE_JOB",{jobId:t})},async updateJob(t,s){return Q("UPDATE_JOB",{jobId:t,updates:s})},async getPages(t){return(await Q("GET_PAGES",{jobId:t})).pages||[]},async search(t){return(await Q("SEARCH",{query:t})).results||[]},async getCrawlStatus(){return Q("GET_CRAWL_STATUS")},onProgress(t){return Pa(t)}},Zt={async getErrorLogs(){return(await Q("GET_ERROR_LOGS")).logs||[]},async getErrorCount(){return(await Q("GET_ERROR_COUNT")).count||0},async clearErrorLogs(){return Q("CLEAR_ERROR_LOGS")},async generateReport(){return(await Q("GENERATE_ERROR_REPORT",{format:"json"})).report},async generateReportString(){return(await Q("GENERATE_ERROR_REPORT",{format:"string"})).report}},Ye={async startPicker(){return Q("START_CONTENT_PICKER")},async savePickedContent(t){return Q("SAVE_PICKED_CONTENT",t)},async getPendingContent(){return new Promise(t=>{chrome.storage.local.get(["pickedContent"],s=>{t(s.pickedContent||null)})})},async clearPendingContent(){return new Promise(t=>{chrome.storage.local.remove(["pickedContent"],()=>{t()})})}};function Ta(){const[t,s]=i.useState(!1),[r,a]=i.useState(null),[n,c]=i.useState({pagesFound:0,pagesProcessed:0,pagesFailed:0,queueSize:0,inProgress:[]}),[h,f]=i.useState(null);return i.useEffect(()=>{te.getCrawlStatus().then(m=>{m.active&&(s(!0),a(m.jobId),c({pagesFound:m.pagesFound||0,pagesProcessed:m.pagesProcessed||0,pagesFailed:0,queueSize:m.queueSize||0,inProgress:m.inProgress||[]}))}).catch(console.error)},[]),i.useEffect(()=>te.onProgress(v=>{c({pagesFound:v.pagesFound||0,pagesProcessed:v.pagesProcessed||0,pagesFailed:v.pagesFailed||0,queueSize:v.queueSize||0,inProgress:v.inProgress||[]}),v.queueSize===0&&(!v.inProgress||v.inProgress.length===0)&&(s(!1),a(null))}),[]),{isActive:t,jobId:r,progress:n,error:h,startCrawl:async(m,v)=>{try{f(null);const d=await te.startCrawl(m,v);s(!0),a(d.jobId),c({pagesFound:0,pagesProcessed:0,pagesFailed:0,queueSize:0,inProgress:[]})}catch(d){throw f(d instanceof Error?d.message:"Failed to start crawl"),d}},cancelCrawl:async()=>{try{await te.cancelCrawl(),s(!1),a(null)}catch(m){throw f(m instanceof Error?m.message:"Failed to cancel crawl"),m}}}}const La=1,$a=2e3;let wt=0;function Ma(){return wt=(wt+1)%Number.MAX_SAFE_INTEGER,wt.toString()}const vt=new Map,qt=t=>{if(vt.has(t))return;const s=setTimeout(()=>{vt.delete(t),Be({type:"REMOVE_TOAST",toastId:t})},$a);vt.set(t,s)},za=(t,s)=>{switch(s.type){case"ADD_TOAST":return{...t,toasts:[s.toast,...t.toasts].slice(0,La)};case"UPDATE_TOAST":return{...t,toasts:t.toasts.map(r=>r.id===s.toast.id?{...r,...s.toast}:r)};case"DISMISS_TOAST":{const{toastId:r}=s;return r?qt(r):t.toasts.forEach(a=>{qt(a.id)}),{...t,toasts:t.toasts.map(a=>a.id===r||r===void 0?{...a,open:!1}:a)}}case"REMOVE_TOAST":return s.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(r=>r.id!==s.toastId)}}},rt=[];let at={toasts:[]};function Be(t){at=za(at,t),rt.forEach(s=>{s(at)})}function Aa({...t}){const s=Ma(),r=n=>Be({type:"UPDATE_TOAST",toast:{...n,id:s}}),a=()=>Be({type:"DISMISS_TOAST",toastId:s});return Be({type:"ADD_TOAST",toast:{...t,id:s,open:!0,onOpenChange:n=>{n||a()}}}),{id:s,dismiss:a,update:r}}function We(){const[t,s]=i.useState(at);return i.useEffect(()=>(rt.push(s),()=>{const r=rt.indexOf(s);r>-1&&rt.splice(r,1)}),[t]),{...t,toast:Aa,dismiss:r=>Be({type:"DISMISS_TOAST",toastId:r})}}const le=i.forwardRef(({className:t,...s},r)=>e.jsx("div",{ref:r,className:N("rounded-lg border bg-card text-card-foreground shadow-sm",t),...s}));le.displayName="Card";const it=i.forwardRef(({className:t,...s},r)=>e.jsx("div",{ref:r,className:N("flex flex-col space-y-1.5 p-6",t),...s}));it.displayName="CardHeader";const lt=i.forwardRef(({className:t,...s},r)=>e.jsx("h3",{ref:r,className:N("text-2xl font-semibold leading-none tracking-tight",t),...s}));lt.displayName="CardTitle";const ct=i.forwardRef(({className:t,...s},r)=>e.jsx("p",{ref:r,className:N("text-sm text-muted-foreground",t),...s}));ct.displayName="CardDescription";const ce=i.forwardRef(({className:t,...s},r)=>e.jsx("div",{ref:r,className:N("p-6 pt-0",t),...s}));ce.displayName="CardContent";const Fa=i.forwardRef(({className:t,...s},r)=>e.jsx("div",{ref:r,className:N("flex items-center p-6 pt-0",t),...s}));Fa.displayName="CardFooter";const Ne=i.forwardRef(({className:t,type:s,...r},a)=>e.jsx("input",{type:s,className:N("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:a,...r}));Ne.displayName="Input";const Kt=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,Qt=Fs,Je=(t,s)=>r=>{var a;if((s==null?void 0:s.variants)==null)return Qt(t,r==null?void 0:r.class,r==null?void 0:r.className);const{variants:n,defaultVariants:c}=s,h=Object.keys(n).map(l=>{const m=r==null?void 0:r[l],v=c==null?void 0:c[l];if(m===null)return null;const d=Kt(m)||Kt(v);return n[l][d]}),f=r&&Object.entries(r).reduce((l,m)=>{let[v,d]=m;return d===void 0||(l[v]=d),l},{}),w=s==null||(a=s.compoundVariants)===null||a===void 0?void 0:a.reduce((l,m)=>{let{class:v,className:d,...A}=m;return Object.entries(A).every(P=>{let[k,p]=P;return Array.isArray(p)?p.includes({...c,...f}[k]):{...c,...f}[k]===p})?[...l,v,d]:l},[]);return Qt(t,h,w,r==null?void 0:r.class,r==null?void 0:r.className)},Ua=Je("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),se=i.forwardRef(({className:t,...s},r)=>e.jsx(rs,{ref:r,className:N(Ua(),t),...s}));se.displayName=rs.displayName;const _a=Je("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),L=i.forwardRef(({className:t,variant:s,size:r,...a},n)=>e.jsx("button",{className:N(_a({variant:s,size:r,className:t})),ref:n,...a}));L.displayName="Button";const Gs=i.forwardRef(({className:t,value:s,...r},a)=>e.jsx(as,{ref:a,className:N("relative h-4 w-full overflow-hidden rounded-full bg-secondary",t),...r,children:e.jsx(vr,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(s||0)}%)`}})}));Gs.displayName=as.displayName;const Ia=Je("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),Rt=i.forwardRef(({className:t,variant:s,...r},a)=>e.jsx("div",{ref:a,role:"alert",className:N(Ia({variant:s}),t),...r}));Rt.displayName="Alert";const Oa=i.forwardRef(({className:t,...s},r)=>e.jsx("h5",{ref:r,className:N("mb-1 font-medium leading-none tracking-tight",t),...s}));Oa.displayName="AlertTitle";const Et=i.forwardRef(({className:t,...s},r)=>e.jsx("div",{ref:r,className:N("text-sm [&_p]:leading-relaxed",t),...s}));Et.displayName="AlertDescription";const Da=Je("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground",success:"border-transparent bg-green-500 text-white hover:bg-green-600",warning:"border-transparent bg-yellow-500 text-white hover:bg-yellow-600"}},defaultVariants:{variant:"default"}});function Ws({className:t,variant:s,...r}){return e.jsx("div",{className:N(Da({variant:s}),t),...r})}const ve=i.forwardRef(({className:t,...s},r)=>e.jsx(os,{ref:r,className:N("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",t),...s,children:e.jsx(yr,{className:N("flex items-center justify-center text-current"),children:e.jsx(Ps,{className:"h-4 w-4"})})}));ve.displayName=os.displayName;const Js=i.forwardRef(({className:t,...s},r)=>e.jsx(ns,{className:N("grid gap-2",t),...s,ref:r}));Js.displayName=ns.displayName;const Pt=i.forwardRef(({className:t,...s},r)=>e.jsx(is,{ref:r,className:N("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),...s,children:e.jsx(jr,{className:"flex items-center justify-center",children:e.jsx(Ts,{className:"h-2.5 w-2.5 fill-current text-current"})})}));Pt.displayName=is.displayName;const Ge=Cr,Ba=Nr,Vs=i.forwardRef(({className:t,...s},r)=>e.jsx(ls,{ref:r,className:N("fixed inset-0 z-50 bg-background/80 backdrop-blur-sm data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...s}));Vs.displayName=ls.displayName;const Le=i.forwardRef(({className:t,children:s,showClose:r=!0,centered:a=!1,...n},c)=>e.jsxs(Ba,{children:[e.jsx(Vs,{}),e.jsxs(cs,{ref:c,className:N(a?"fixed left-[50%] top-[50%] z-50 translate-x-[-50%] translate-y-[-50%] w-full border rounded-lg bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95":"fixed right-0 top-0 z-50 h-full w-full max-w-full flex flex-col gap-4 border-l bg-background p-6 shadow-lg duration-300 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right",t),...n,children:[s,r&&e.jsxs(kr,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[e.jsx(Mt,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Le.displayName=cs.displayName;const ye=i.forwardRef(({className:t,...s},r)=>e.jsx(ds,{ref:r,className:N("text-lg font-semibold leading-none tracking-tight",t),...s}));ye.displayName=ds.displayName;const dt=i.forwardRef(({className:t,...s},r)=>e.jsx(us,{ref:r,className:N("text-sm text-muted-foreground",t),...s}));dt.displayName=us.displayName;function Ga(){const[t,s]=i.useState([""]),[r,a]=i.useState("crawl-url"),[n,c]=i.useState(null),[h,f]=i.useState(!1),[w,l]=i.useState(!1),[m,v]=i.useState(!1),[d,A]=i.useState(5),[P,k]=i.useState(!1),[p,$]=i.useState(100),[T,J]=i.useState(!0),[U,Y]=i.useState(!1),[K,de]=i.useState(!1),[g,R]=i.useState(1),[x,M]=i.useState(!1),[C,_]=i.useState(!1),{isActive:O,progress:W,error:ee,startCrawl:ue,cancelCrawl:pe}=Ta(),{toast:B}=We(),re=i.useRef(!1),H=i.useRef(!1),Me=()=>{s([...t,""])},mt=b=>{t.length>1&&s(t.filter((y,z)=>z!==b))},ze=(b,y)=>{const z=[...t];z[b]=y,s(z)},Ae=async(b,y=!1)=>{try{let V=(await chrome.tabs.query({active:!0,lastFocusedWindow:!0}))[0];if(V||(V=(await chrome.tabs.query({active:!0,currentWindow:!0}))[0]),!(V!=null&&V.url)){y||B({variant:"destructive",title:"Cannot get current page",description:"No active tab found or URL is not accessible"});return}const X=V.url;if(!X.startsWith("http://")&&!X.startsWith("https://")){y||B({variant:"destructive",title:"Invalid page",description:"Current page is not a web page (http/https)"});return}ze(b,X)}catch(z){console.error("Failed to get current tab URL:",z),y||B({variant:"destructive",title:"Failed to get URL",description:z instanceof Error?z.message:"Unknown error"})}},ht=b=>{const y=/https?:\/\/(?:localhost|(?:[\w-]+\.)+[\w-]+|\d{1,3}(?:\.\d{1,3}){3})(?::\d+)?(?:\/[^\s<>"'`\[\]{}|\\^]*)?/gi,V=(b.match(y)||[]).map(X=>X.replace(/[.,;:!?)>\]']+$/,""));return[...new Set(V)].filter(X=>X.length>0)},Ve=(b,y)=>{const z=b.clipboardData.getData("text"),V=ht(z);if(V.length!==0)if(b.preventDefault(),V.length===1)ze(y,V[0]);else{const X=[...t];X.splice(y,1,...V),s(X),B({title:`${V.length} URLs detected`,description:"Multiple URLs have been added from your paste"})}},He=async()=>{const b=t.map(y=>y.trim()).filter(y=>y.length>0);if(b.length!==0){_(!0);try{const y={skipCache:m,maxWorkers:d,pageLimit:P?p:null,strictPathMatching:T,useIncognito:U,followExternalLinks:K,maxExternalHops:K?g:1},z=b.length===1?b[0]:b;B({title:"Starting capture...",description:`Capturing pages from ${b.length} base path${b.length>1?"s":""}`}),await ue(z,y)}catch(y){console.error("Failed to start capture:",y),_(!1),B({variant:"destructive",title:"Failed to start capture",description:y instanceof Error?y.message:"Unknown error occurred"})}}},Ze=async()=>{try{H.current=!0,await pe()}catch(b){console.error("Failed to cancel crawl:",b),H.current=!1}},me=async()=>{try{n&&(c(null),await Ye.clearPendingContent());const b=await Ye.startPicker();if(b.error){B({variant:"destructive",title:"Cannot start content picker",description:b.error});return}window.close()}catch(b){console.error("Failed to start content picker:",b),B({variant:"destructive",title:"Failed to start content picker",description:b instanceof Error?b.message:"Unknown error occurred"})}},ke=async()=>{if(n){f(!0);try{const b=await Ye.savePickedContent(n);if(b.error)throw new Error(b.error);B({variant:"success",title:"Content Saved",description:`Saved content from ${n.url}`}),c(null),await Ye.clearPendingContent()}catch(b){console.error("Failed to save picked content:",b),B({variant:"destructive",title:"Failed to save",description:b instanceof Error?b.message:"Unknown error occurred"})}finally{f(!1)}}},Ce=async b=>{if(b&&!await new Promise(z=>{chrome.extension.isAllowedIncognitoAccess(V=>{z(V)})})){M(!0);return}Y(b)},Fe=W.pagesFound>0?W.pagesProcessed/W.pagesFound*100:0;return i.useEffect(()=>{O&&C&&_(!1)},[O,C]),i.useEffect(()=>{re.current&&!O&&W.pagesProcessed>0&&(H.current?(B({variant:"warning",title:"Capture Cancelled",description:`Stopped after capturing ${W.pagesProcessed} page${W.pagesProcessed!==1?"s":""}`}),H.current=!1):B({variant:"success",title:"Capture Complete!",description:`Successfully captured ${W.pagesProcessed} pages`})),re.current=O},[O,W.pagesProcessed,B]),i.useEffect(()=>{(async()=>{var y;try{const z=await chrome.storage.local.get(["pickedContent","crawlMode"]);(z.crawlMode==="pick-content"||z.crawlMode==="crawl-url")&&a(z.crawlMode),(y=z.pickedContent)!=null&&y.url&&(c(z.pickedContent),a("pick-content"));const V=z.crawlMode==="crawl-url"||!z.crawlMode,X=t[0].trim()==="";V&&X&&await Ae(0,!0)}catch(z){console.error("[CrawlTab] Failed to initialize state:",z)}})()},[]),i.useEffect(()=>{chrome.storage.local.set({crawlMode:r})},[r]),e.jsxs("div",{className:"relative flex flex-col h-full",children:[e.jsxs("div",{className:"flex-1 overflow-y-auto pb-16",children:[C&&e.jsx(le,{children:e.jsx(ce,{className:"pt-6",children:e.jsxs("div",{className:"flex flex-col items-center justify-center space-y-4 py-8",children:[e.jsx(ie,{className:"h-12 w-12 animate-spin text-primary"}),e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("p",{className:"text-lg font-medium",children:"Initializing..."}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Setting up workers and discovering initial URLs"})]})]})})}),!O&&!C&&e.jsxs(le,{children:[e.jsxs(it,{className:"space-y-3",children:[e.jsxs(Js,{value:r,onValueChange:b=>a(b),className:"flex items-center gap-6",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Pt,{value:"crawl-url",id:"crawl-url"}),e.jsx(se,{htmlFor:"crawl-url",className:"cursor-pointer font-normal",children:"Capture Site"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Pt,{value:"pick-content",id:"pick-content"}),e.jsx(se,{htmlFor:"pick-content",className:"cursor-pointer font-normal",children:"Pick Content"})]})]}),e.jsxs("div",{children:[e.jsx(lt,{className:"text-lg",children:r==="crawl-url"?"Capture Web Pages":"Pick Content"}),e.jsx(ct,{children:r==="crawl-url"?"Paste multiple URLs at once or add them one by one":"Select and extract content from any web page"})]})]}),e.jsxs(ce,{className:"space-y-4",children:[r==="crawl-url"&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs(se,{children:["Target URL",t.length>1?"s":""]}),t.map((b,y)=>e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(Ne,{type:"url",placeholder:y===0?"https://docs.stripe.com/api":"https://docs.stripe.com/sdk",value:b,onChange:z=>ze(y,z.target.value),onKeyDown:z=>z.key==="Enter"&&He(),onPaste:z=>Ve(z,y),className:"flex-1"}),e.jsx(L,{type:"button",variant:"ghost",size:"sm",onClick:()=>Ae(y),className:"h-9 w-9 p-0 text-muted-foreground hover:text-primary shrink-0",title:"Use current page URL",children:e.jsx(Ls,{className:"h-4 w-4"})}),t.length>1&&e.jsx(L,{type:"button",variant:"ghost",size:"sm",onClick:()=>mt(y),className:"h-9 w-9 p-0 text-muted-foreground hover:text-destructive shrink-0",children:e.jsx(Mt,{className:"h-4 w-4"})})]},y)),e.jsxs(L,{type:"button",variant:"outline",size:"sm",onClick:Me,className:"w-full",children:[e.jsx(Ar,{className:"h-4 w-4 mr-2"}),"Add Another URL"]})]}),r==="crawl-url"&&e.jsxs("div",{className:"border rounded-lg p-3 space-y-3",children:[e.jsxs("button",{type:"button",onClick:()=>l(!w),className:"flex items-center justify-between w-full text-sm font-medium",children:[e.jsx("span",{children:"Advanced Options"}),w?e.jsx(Fr,{className:"h-4 w-4"}):e.jsx(zt,{className:"h-4 w-4"})]}),w&&e.jsxs("div",{className:"space-y-4 pt-2 border-t",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(se,{htmlFor:"maxWorkers",className:"text-sm font-medium",children:"Concurrent Tabs (Workers)"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ne,{id:"maxWorkers",type:"number",min:1,max:10,value:d,onChange:b=>{const y=parseInt(b.target.value);!isNaN(y)&&y>=1&&y<=10&&A(y)},className:"w-20"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"tabs (1-10, default: 5)"})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Number of browser tabs opened simultaneously to capture pages. More tabs = faster capturing but higher resource usage."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ve,{id:"enablePageLimit",checked:P,onCheckedChange:b=>k(b)}),e.jsx(se,{htmlFor:"enablePageLimit",className:"text-sm font-medium cursor-pointer",children:"Limit Number of Pages"})]}),P&&e.jsxs("div",{className:"pl-6 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Ne,{id:"pageLimit",type:"number",min:1,value:p,onChange:b=>{const y=parseInt(b.target.value);!isNaN(y)&&y>=1&&$(y)},className:"w-24"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"pages maximum"})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Stop after processing this many pages. Job will be marked as completed when limit is reached."})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(ve,{id:"strictPathMatching",checked:T,onCheckedChange:b=>J(b)}),e.jsx(se,{htmlFor:"strictPathMatching",className:"text-sm font-medium cursor-pointer",children:"Strict Path Matching"})]}),e.jsxs("p",{className:"text-xs text-muted-foreground pl-6",children:["Only capture pages under the exact path hierarchy. When enabled, ",e.jsx("code",{className:"text-xs bg-muted px-1 py-0.5 rounded",children:"/financial-apis"})," will match ",e.jsx("code",{className:"text-xs bg-muted px-1 py-0.5 rounded",children:"/financial-apis/overview"})," but NOT ",e.jsx("code",{className:"text-xs bg-muted px-1 py-0.5 rounded",children:"/financial-apis-blog"}),"."]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(ve,{id:"skipCache",checked:m,onCheckedChange:b=>v(b)}),e.jsx(se,{htmlFor:"skipCache",className:"text-sm font-medium cursor-pointer",children:"Force Refresh (Skip Cache)"})]}),e.jsx("p",{className:"text-xs text-muted-foreground pl-6",children:"Re-capture pages even if already in database. Use this to refresh content from previously captured sites."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(ve,{id:"useIncognito",checked:U,onCheckedChange:b=>Ce(b)}),e.jsx(se,{htmlFor:"useIncognito",className:"text-sm font-medium cursor-pointer",children:"Incognito Mode"})]}),e.jsx("p",{className:"text-xs text-muted-foreground pl-6",children:"Capture in a new incognito window for a clean session (no cookies, cache, or logged-in states)."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx(ve,{id:"followExternalLinks",checked:K,onCheckedChange:b=>de(b)}),e.jsx(se,{htmlFor:"followExternalLinks",className:"text-sm font-medium cursor-pointer",children:"Follow External Links"})]}),e.jsx("p",{className:"text-xs text-muted-foreground pl-6",children:"Also follow links that point outside the base URL path(s). Useful for documentation that spans multiple domains or sections."}),K&&e.jsxs("div",{className:"pl-6 space-y-2 pt-2",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(se,{htmlFor:"maxExternalHops",className:"text-sm whitespace-nowrap",children:"Max hops:"}),e.jsx(Ne,{id:"maxExternalHops",type:"number",min:1,max:5,value:g,onChange:b=>{const y=parseInt(b.target.value);!isNaN(y)&&y>=1&&y<=5&&R(y)},className:"w-16"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"(1-5)"})]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["How many levels deep to follow external links. ",e.jsx("span",{className:"font-medium",children:"1"})," = only direct links from base pages, ",e.jsx("span",{className:"font-medium",children:"2"})," = also links from those pages, etc."]})]})]})]})]}),r==="crawl-url"&&ee&&e.jsxs(Rt,{variant:"destructive",children:[e.jsx(nt,{className:"h-4 w-4"}),e.jsx(Et,{children:ee})]}),r==="crawl-url"&&e.jsx("p",{className:"text-xs text-muted-foreground",children:"ðŸ’¡ Tip: Only one capture allowed at a time"}),r==="pick-content"&&e.jsxs("div",{className:"space-y-4",children:[!n&&e.jsxs("div",{className:"space-y-3 text-sm text-muted-foreground",children:[e.jsxs("div",{className:"flex gap-3",children:[e.jsx(gt,{className:"h-5 w-5 shrink-0 text-primary mt-0.5"}),e.jsxs("p",{children:["Click ",e.jsx("span",{className:"font-medium text-foreground",children:'"Start Selecting Content"'})," to begin selecting content on the current web page."]})]}),e.jsxs("div",{className:"pl-8 space-y-2",children:[e.jsx("p",{children:"When you select content:"}),e.jsxs("ul",{className:"list-disc pl-4 space-y-1",children:[e.jsx("li",{children:"Content is extracted as HTML, Markdown, and plain text"}),e.jsx("li",{children:"Markdown is automatically copied to your clipboard"})]})]})]}),n&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("p",{className:"text-sm text-green-600 font-medium flex items-center gap-2",children:[e.jsx("span",{className:"h-2 w-2 rounded-full bg-green-500"}),"Content ready to save"]}),e.jsxs("p",{className:"text-xs text-muted-foreground truncate",children:["From: ",n.url]})]})]})]})]}),O&&e.jsxs(le,{children:[e.jsx(it,{children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsxs(lt,{className:"text-lg flex items-center gap-2",children:[e.jsx(ie,{className:"h-4 w-4 animate-spin"}),"Capture in Progress"]}),e.jsxs(ct,{className:"mt-1",children:["Extracting content from ",t.filter(b=>b.trim()).length," base path",t.filter(b=>b.trim()).length>1?"s":""]})]})})}),e.jsxs(ce,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Progress"}),e.jsxs("span",{className:"font-medium",children:[W.pagesProcessed," / ",W.pagesFound," pages"]})]}),e.jsx(Gs,{value:Fe,className:"h-2"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-primary",children:W.pagesFound}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Found"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-green-500",children:W.pagesProcessed}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"Processed"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-500",children:W.queueSize}),e.jsx("div",{className:"text-xs text-muted-foreground",children:"In Queue"})]})]}),W.inProgress&&W.inProgress.length>0&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-sm font-medium",children:"Currently Processing:"}),e.jsx("div",{className:"space-y-1",children:W.inProgress.slice(0,3).map((b,y)=>e.jsxs("div",{className:"text-xs text-muted-foreground truncate flex items-center gap-2",children:[e.jsx(Ws,{variant:"outline",className:"text-xs",children:e.jsx(ie,{className:"h-3 w-3 animate-spin mr-1"})}),b]},y))})]}),e.jsx(L,{variant:"destructive",className:"w-full",onClick:Ze,children:"Stop Capture"}),e.jsx(Rt,{children:e.jsx(Et,{className:"text-xs",children:"â„¹ï¸ You can close this popup. Capture will continue in the background."})})]})]})]}),!O&&e.jsxs("div",{className:"absolute bottom-4 left-4 right-4",children:[(r==="crawl-url"||!n)&&e.jsx(L,{className:"w-full shadow-lg",size:"lg",onClick:r==="crawl-url"?He:me,disabled:r==="crawl-url"?t.filter(b=>b.trim()).length===0||O||C:!1,children:C?e.jsxs(e.Fragment,{children:[e.jsx(ie,{className:"h-4 w-4 mr-2 animate-spin"}),"Starting..."]}):r==="crawl-url"?"Start Capture":e.jsxs(e.Fragment,{children:[e.jsx(gt,{className:"h-4 w-4 mr-2"}),"Start Selecting Content"]})}),r==="pick-content"&&n&&e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(L,{variant:"outline",className:"flex-1 shadow-lg",size:"lg",onClick:me,children:[e.jsx(gt,{className:"h-4 w-4 mr-2"}),"Reselect"]}),e.jsx(L,{className:"flex-1 shadow-lg",size:"lg",onClick:ke,disabled:h,children:h?e.jsxs(e.Fragment,{children:[e.jsx(ie,{className:"h-4 w-4 mr-2 animate-spin"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ur,{className:"h-4 w-4 mr-2"}),"Save Selection"]})})]})]}),e.jsx(Ge,{open:x,onOpenChange:M,children:e.jsxs(Le,{centered:!0,className:"max-w-[340px] sm:max-w-[400px]",children:[e.jsxs(ye,{className:"flex items-center gap-2 text-base",children:[e.jsx(_r,{className:"h-5 w-5 text-yellow-500"}),"Incognito Mode Not Available"]}),e.jsx(dt,{asChild:!0,children:e.jsxs("div",{className:"space-y-3 pt-2",children:[e.jsx("p",{className:"text-sm",children:"To use Incognito Mode, you need to enable this extension in Chrome's incognito settings."}),e.jsxs("div",{className:"bg-muted/50 p-3 rounded-md space-y-2",children:[e.jsx("p",{className:"text-sm font-medium",children:"How to enable:"}),e.jsxs("ol",{className:"text-xs text-muted-foreground list-decimal list-inside space-y-1",children:[e.jsxs("li",{children:["Go to ",e.jsx("code",{className:"bg-muted px-1 py-0.5 rounded text-xs",children:"chrome://extensions"})]}),e.jsx("li",{children:'Find "Webscribe" and click "Details"'}),e.jsx("li",{children:'Enable "Allow in Incognito"'})]})]})]})}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(L,{variant:"outline",onClick:()=>M(!1),children:"Got it"}),e.jsx(L,{onClick:()=>{chrome.tabs.create({url:"chrome://extensions/?id="+chrome.runtime.id}),M(!1)},children:"Open Settings"})]})]})})]})}function Wa(){const[t,s]=i.useState([]),[r,a]=i.useState(!0),[n,c]=i.useState(null),h=i.useCallback(async()=>{try{a(!0),c(null);const l=await te.getJobs();s(l)}catch(l){c(l instanceof Error?l.message:"Failed to load jobs")}finally{a(!1)}},[]);return i.useEffect(()=>{h()},[h]),{jobs:t,loading:r,error:n,refresh:h,deleteJob:async l=>{try{await te.deleteJob(l),await h()}catch(m){throw new Error(m instanceof Error?m.message:"Failed to delete job")}},getJobPages:async l=>{try{return await te.getPages(l)}catch(m){throw new Error(m instanceof Error?m.message:"Failed to load pages")}}}}function Ja(){const[t,s]=i.useState([]),[r,a]=i.useState(!1),[n,c]=i.useState(null),h=i.useCallback(async w=>{if(!w.trim()){s([]);return}try{a(!0),c(null);const l=await te.search(w);s(l)}catch(l){c(l instanceof Error?l.message:"Search failed"),s([])}finally{a(!1)}},[]),f=i.useCallback(()=>{s([]),c(null)},[]);return{results:t,loading:r,error:n,search:h,clear:f}}const Ut=i.forwardRef(({className:t,children:s,horizontal:r=!1,...a},n)=>e.jsxs(ps,{ref:n,className:N("relative overflow-hidden",t),...a,children:[e.jsx(Sr,{className:N("h-full w-full rounded-[inherit]",r&&"overflow-x-auto"),children:s}),e.jsx(Tt,{}),r&&e.jsx(Tt,{orientation:"horizontal"}),e.jsx(Rr,{})]}));Ut.displayName=ps.displayName;const Tt=i.forwardRef(({className:t,orientation:s="vertical",...r},a)=>e.jsx(ms,{ref:a,orientation:s,className:N("flex touch-none select-none transition-colors",s==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",s==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",t),...r,children:e.jsx(Er,{className:"relative flex-1 rounded-full bg-border"})}));Tt.displayName=ms.displayName;const Lt=Tr,$t=Lr,Va=i.forwardRef(({className:t,inset:s,children:r,...a},n)=>e.jsxs(hs,{ref:n,className:N("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",s&&"pl-8",t),...a,children:[r,e.jsx(Ee,{className:"ml-auto h-4 w-4"})]}));Va.displayName=hs.displayName;const Ha=i.forwardRef(({className:t,...s},r)=>e.jsx(fs,{ref:r,className:N("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...s}));Ha.displayName=fs.displayName;const ut=i.forwardRef(({className:t,sideOffset:s=4,...r},a)=>e.jsx(Pr,{children:e.jsx(xs,{ref:a,sideOffset:s,className:N("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...r})}));ut.displayName=xs.displayName;const q=i.forwardRef(({className:t,inset:s,...r},a)=>e.jsx(gs,{ref:a,className:N("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s&&"pl-8",t),...r}));q.displayName=gs.displayName;const Za=i.forwardRef(({className:t,children:s,checked:r,...a},n)=>e.jsxs(bs,{ref:n,className:N("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),checked:r,...a,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(ws,{children:e.jsx(Ps,{className:"h-4 w-4"})})}),s]}));Za.displayName=bs.displayName;const qa=i.forwardRef(({className:t,children:s,...r},a)=>e.jsxs(vs,{ref:a,className:N("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...r,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(ws,{children:e.jsx(Ts,{className:"h-2 w-2 fill-current"})})}),s]}));qa.displayName=vs.displayName;const ge=i.forwardRef(({className:t,inset:s,...r},a)=>e.jsx(ys,{ref:a,className:N("px-2 py-1.5 text-sm font-semibold",s&&"pl-8",t),...r}));ge.displayName=ys.displayName;const be=i.forwardRef(({className:t,...s},r)=>e.jsx(js,{ref:r,className:N("-mx-1 my-1 h-px bg-muted",t),...s}));be.displayName=js.displayName;function et(t){let s=t.replace(/^https?:\/\//,"")||"index";return s=s.replace(/[<>:"/\\|?*]/g,"_"),s=s.replace(/\//g,"-"),s=s.replace(/[-_]+/g,"-"),s.length>200&&(s=s.substring(0,200)),s=s.replace(/[.\s\-_]+$/,""),s||"page"}function Hs(t){const s=t.metadata,r=t.alternateUrls,a=[];if(!s||Object.keys(s).length===0)return r&&r.length>1&&a.push(`Alternate URLs: ${r.slice(1).join(", ")}`),a.length>0?`
`+a.join(`
`)+`
`:"";s.canonical&&a.push(`Canonical URL: ${s.canonical}`),r&&r.length>1&&a.push(`Alternate URLs: ${r.slice(1).join(", ")}`),s.ogTitle&&a.push(`Title: ${s.ogTitle}`);const n=s.description||s.ogDescription;return n&&a.push(`Description: ${n}`),s.generator&&a.push(`Generator: ${s.generator}`),s.ogType&&a.push(`Type: ${s.ogType}`),s.keywords&&a.push(`Keywords: ${s.keywords}`),s.author&&a.push(`Author: ${s.author}`),s.ogSiteName&&a.push(`Site Name: ${s.ogSiteName}`),s.articleSection&&a.push(`Section: ${s.articleSection}`),s.articleTags&&s.articleTags.length>0&&a.push(`Tags: ${s.articleTags.join(", ")}`),s.jsonLd&&(s.jsonLd.headline&&a.push(`Headline: ${s.jsonLd.headline}`),s.jsonLd.type&&a.push(`Schema Type: ${s.jsonLd.type}`)),a.length>0?`
`+a.join(`
`)+`
`:""}function we(t){return t.map(s=>{const r="=".repeat(80),a=Hs(s);return`${r}
URL: ${s.url}${a}
${r}

${s.content}

`}).join(`
`)}function Xt(t,s=.5){return t.map(r=>{if(_t(r,s))return Pe(r);{const a="=".repeat(80),n=Hs(r);return`${a}
URL: ${r.url}${n}
${a}

${r.content}

`}}).join(`
---

`)}function ot(t){const s=we(t);return new Blob([s]).size}function Oe(t){if(t===0)return"0 Bytes";const s=1024,r=["Bytes","KB","MB","GB"],a=Math.floor(Math.log(t)/Math.log(s));return Math.round(t/Math.pow(s,a)*100)/100+" "+r[a]}function tt(t){return ot(t)/(1024*1024)<=10}function st(t){try{const s=new URL(t),r=s.hostname.replace(/^www\./,""),a=s.pathname.replace(/\//g,"-").replace(/^-|-$/g,"");let n=r;return a&&(n+=`-${a}`),n=n.replace(/[<>:"/\\|?*]/g,"_"),n=n.replace(/[-_]+/g,"-"),n||"export"}catch{return"export"}}function De(t,s,r=.5){return s==="html"?t.html?{format:"html",content:t.html,fallback:!1}:{format:"text",content:t.content,fallback:!0,reason:"unavailable"}:s==="markdown"?t.markdown&&t.markdownMeta?t.markdownMeta.confidence>=r?{format:"markdown",content:t.markdown,fallback:!1}:{format:"text",content:t.content,fallback:!0,reason:"low-confidence"}:{format:"text",content:t.content,fallback:!0,reason:t.markdown?"metadata-missing":"unavailable"}:{format:"text",content:t.content,fallback:!1}}function _t(t,s=.5){return!!(t.markdown&&t.markdownMeta&&t.markdownMeta.confidence>=s)}function Ka(t){return!!(t.html&&t.html.length>0)}function Qa(t){const s=t.url,r=t.metadata,a=t.alternateUrls,n=["---",`url: ${s}`];if(!r||Object.keys(r).length===0)return a&&a.length>1&&(n.push("alternate_urls:"),a.forEach(h=>{n.push(`  - ${h}`)})),n.push("---"),n.join(`
`)+`

`;if(r.canonical&&n.push(`canonical: ${r.canonical}`),a&&a.length>1&&(n.push("alternate_urls:"),a.forEach(h=>{n.push(`  - ${h}`)})),r.ogTitle){const h=r.ogTitle.replace(/"/g,'\\"');n.push(`title: "${h}"`)}const c=r.description||r.ogDescription;if(c){const h=c.replace(/"/g,'\\"');n.push(`description: "${h}"`)}if(r.generator&&n.push(`generator: ${r.generator}`),r.ogType&&n.push(`type: ${r.ogType}`),r.keywords&&n.push(`keywords: ${r.keywords}`),r.author&&n.push(`author: ${r.author}`),r.ogSiteName&&n.push(`og_site_name: ${r.ogSiteName}`),r.articleSection&&n.push(`section: ${r.articleSection}`),r.articleTags&&r.articleTags.length>0&&(n.push("tags:"),r.articleTags.forEach(h=>{n.push(`  - ${h}`)})),r.jsonLd){if(r.jsonLd.headline){const h=r.jsonLd.headline.replace(/"/g,'\\"');n.push(`headline: "${h}"`)}r.jsonLd.type&&n.push(`schema_type: ${r.jsonLd.type}`)}return n.push("---"),n.join(`
`)+`

`}function Pe(t){return Qa(t)+(t.markdown||"")}const pt=new At.Renderer,Xa=pt.link.bind(pt);pt.link=function(t,s,r){return Xa(t,s,r).replace(/^<a /,'<a target="_blank" rel="noopener noreferrer" ')};At.setOptions({breaks:!0,gfm:!0,renderer:pt});function Ya(t){if(!t.startsWith(`---
`))return t;const s=t.indexOf(`
---
`,4);if(s===-1)return t;const r=t.substring(4,s),a=t.substring(s+5),n=r.split(`
`).filter(w=>w.trim()),c=[];for(let w=0;w<n.length;w++){const l=n[w];if(l.trim().startsWith("- "))continue;const m=l.indexOf(":");if(m===-1)continue;let v=l.substring(0,m).trim(),d=l.substring(m+1).trim();if(!d&&w+1<n.length&&n[w+1].trim().startsWith("- ")){const A=[];let P=w+1;for(;P<n.length&&n[P].trim().startsWith("- ");)A.push(n[P].trim().substring(2)),P++;if(A.length>0){const k=v.split("_").map(p=>p.charAt(0).toUpperCase()+p.slice(1)).join(" ");c.push({label:k,value:A.join(", ")})}continue}d&&((d.startsWith('"')&&d.endsWith('"')||d.startsWith("'")&&d.endsWith("'"))&&(d=d.substring(1,d.length-1)),v=v.split("_").map(A=>A.charAt(0).toUpperCase()+A.slice(1)).join(" "),c.push({label:v,value:d}))}return`<div class="metadata-callout">
  <div class="metadata-callout-header">ðŸ“„ Page Metadata</div>
  <ul class="metadata-callout-list">
${c.map(w=>`  <li><strong>${w.label}:</strong> ${w.value}</li>`).join(`
`)}
  </ul>
</div>

${a}`}function eo(t){const s='<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"/><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"/></svg>',r='<svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="20 6 9 17 4 12"/></svg>';return t.replace(/<pre(\s[^>]*)?>([\s\S]*?)<\/pre>/gi,(a,n,c)=>`<div class="code-block-wrapper">
      <button class="code-copy-btn" title="Copy code" data-copy-icon='${s}' data-check-icon='${r}'>
        ${s}
      </button>
      <pre${n||""}>${c}</pre>
    </div>`)}function to({page:t,confidenceThreshold:s=.5,defaultFormat:r="markdown"}){const{toast:a}=We(),n=i.useRef(null),c=i.useMemo(()=>_t(t,s),[t,s]),h=i.useMemo(()=>Ka(t),[t]),[f,w]=i.useState(c?r:"text"),l=i.useMemo(()=>De(t,f,s),[t,f,s]),m=i.useMemo(()=>l.format==="html"?t.html||"":l.format==="text"?we([t]):Pe(t),[t,l.format]),v=i.useMemo(()=>{if(l.format==="markdown"&&m)try{const p=Ya(m),$=At.parse(p);return eo($)}catch(p){return console.error("Error rendering markdown:",p),null}return null},[m,l.format]),d=i.useCallback(async p=>{const $=p.closest(".code-block-wrapper"),T=$==null?void 0:$.querySelector("pre");if(!T)return;const J=T.textContent||"";try{await navigator.clipboard.writeText(J);const U=p.getAttribute("data-copy-icon")||"",Y=p.getAttribute("data-check-icon")||"";p.innerHTML=Y,p.classList.add("copied"),setTimeout(()=>{p.innerHTML=U,p.classList.remove("copied")},2e3),a({title:"Code copied",description:"Code block copied to clipboard"})}catch(U){console.error("Failed to copy code:",U),a({variant:"destructive",title:"Copy failed",description:"Failed to copy code to clipboard"})}},[a]);i.useEffect(()=>{const p=n.current;if(!p)return;const $=T=>{const U=T.target.closest(".code-copy-btn");U&&(T.preventDefault(),T.stopPropagation(),d(U))};return p.addEventListener("click",$),()=>p.removeEventListener("click",$)},[v,d]);const A=()=>{navigator.clipboard.writeText(m);const p=l.format==="markdown"?"Markdown":l.format==="html"?"HTML":"Raw text";a({title:"Copied to clipboard",description:`${p} content copied successfully`})},P=()=>{const p=l.format==="markdown"?"md":l.format==="html"?"html":"txt",$=l.format==="html"?"text/html":"text/plain",T=new Blob([m],{type:$}),J=URL.createObjectURL(T),U=document.createElement("a");U.href=J,U.download=`${t.url.split("/").pop()||"page"}.${p}`,document.body.appendChild(U),U.click(),document.body.removeChild(U),URL.revokeObjectURL(J),a({title:"Downloaded",description:`Page downloaded as ${p.toUpperCase()} file`})},k=async()=>{await chrome.storage.local.set({previewData:{content:m,format:f,url:t.url,title:t.url.split("/").pop()||"Content Preview"}}),chrome.windows.create({url:chrome.runtime.getURL("preview.html"),type:"popup",width:1e3,height:800,focused:!0})};return e.jsxs("div",{className:"flex flex-col flex-1 overflow-hidden",children:[e.jsx("div",{className:"px-4 py-2 border-b flex items-center shrink-0 bg-muted/30",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:"Format:"}),e.jsxs("div",{className:"flex items-center gap-1 border rounded-md p-0.5 bg-background",children:[e.jsxs(L,{size:"sm",variant:f==="text"?"default":"ghost",onClick:()=>w("text"),className:"h-6 px-2 text-xs gap-1.5",children:[e.jsx(xe,{className:"h-3 w-3"}),"Raw Text"]}),e.jsxs(L,{size:"sm",variant:f==="markdown"?"default":"ghost",onClick:()=>w("markdown"),className:"h-6 px-2 text-xs gap-1.5",disabled:!c,title:c?void 0:"Markdown not available for this page",children:[e.jsx(Ir,{className:"h-3 w-3"}),"Markdown"]}),e.jsxs(L,{size:"sm",variant:f==="html"?"default":"ghost",onClick:()=>w("html"),className:"h-6 px-2 text-xs gap-1.5",disabled:!h,title:h?void 0:"HTML not available for this page",children:[e.jsx(Or,{className:"h-3 w-3"}),"HTML"]})]})]})}),l.fallback&&e.jsx("div",{className:"px-4 py-2 bg-yellow-50 dark:bg-yellow-950/20 border-b border-yellow-200 dark:border-yellow-800",children:e.jsxs("p",{className:"text-xs text-yellow-800 dark:text-yellow-200",children:["âš ï¸ ",f==="html"?"HTML":"Markdown"," unavailable (",l.reason==="low-confidence"?"low confidence":"not generated","). Showing text format."]})}),e.jsx("div",{className:"flex-1 px-2 py-2 overflow-hidden",children:e.jsx(Ut,{className:"h-full",horizontal:!0,children:v?e.jsx("div",{ref:n,className:"prose prose-sm dark:prose-invert max-w-full w-full p-3 break-words overflow-x-auto prose-headings:font-semibold prose-h1:text-xl prose-h2:text-lg prose-h3:text-base prose-p:text-sm prose-li:text-sm prose-code:text-xs prose-pre:text-xs prose-img:rounded-md [&_pre]:overflow-x-auto [&_.code-block-wrapper]:relative [&_.code-block-wrapper]:group [&_.code-copy-btn]:absolute [&_.code-copy-btn]:top-2 [&_.code-copy-btn]:right-2 [&_.code-copy-btn]:p-1.5 [&_.code-copy-btn]:rounded-md [&_.code-copy-btn]:bg-muted/80 [&_.code-copy-btn]:hover:bg-muted [&_.code-copy-btn]:border [&_.code-copy-btn]:border-border/50 [&_.code-copy-btn]:text-muted-foreground [&_.code-copy-btn]:hover:text-foreground [&_.code-copy-btn]:opacity-0 [&_.code-block-wrapper:hover_.code-copy-btn]:opacity-100 [&_.code-copy-btn]:transition-opacity [&_.code-copy-btn]:cursor-pointer [&_.code-copy-btn.copied]:text-green-500 [&_.code-copy-btn.copied]:opacity-100 [&_.code-copy-btn]:flex [&_.code-copy-btn]:items-center [&_.code-copy-btn]:justify-center",dangerouslySetInnerHTML:{__html:v}}):e.jsx("pre",{className:"text-xs whitespace-pre-wrap font-mono p-2 overflow-x-auto break-words w-full",children:m})})}),e.jsxs("div",{className:"px-4 py-3 border-t flex justify-between items-center bg-muted/50 shrink-0",children:[e.jsx("div",{className:"flex items-center border rounded-md overflow-hidden",children:e.jsxs(L,{size:"sm",variant:"ghost",onClick:k,className:"h-7 px-3 text-xs rounded-none hover:bg-accent gap-1.5",title:"Open content in a larger window for comfortable reading",children:[e.jsx($s,{className:"h-3 w-3"}),"Open in Window"]})}),e.jsxs("div",{className:"flex items-center border rounded-md overflow-hidden",children:[e.jsxs(L,{size:"sm",variant:"ghost",onClick:A,className:"h-7 px-3 text-xs rounded-none border-r hover:bg-accent",children:[e.jsx(ne,{className:"h-3 w-3 mr-1.5"}),"Copy Page"]}),e.jsxs(Lt,{children:[e.jsx($t,{asChild:!0,children:e.jsx(L,{size:"sm",variant:"ghost",className:"h-7 px-2 rounded-none hover:bg-accent",children:e.jsx(zt,{className:"h-3 w-3"})})}),e.jsx(ut,{align:"end",children:e.jsxs(q,{onClick:P,children:[e.jsx(Ms,{className:"h-3 w-3 mr-2"}),"Download as ",l.format==="markdown"?".md":l.format==="html"?".html":".txt"]})})]})]})]})]})}function so(){var Gt;const{jobs:t,loading:s,deleteJob:r,getJobPages:a,refresh:n}=Wa(),{results:c,loading:h,search:f,clear:w}=Ja(),{toast:l}=We(),[m,v]=i.useState("closed"),[d,A]=i.useState(null),[P,k]=i.useState(null),[p,$]=i.useState([]),[T,J]=i.useState(!1),[U,Y]=i.useState(""),[K,de]=i.useState(""),[g]=i.useState("markdown"),R=.5,[x,M]=i.useState(new Set),[C,_]=i.useState(null),[O,W]=i.useState([]),[ee,ue]=i.useState(null),[pe,B]=i.useState(!1),re=50,[H,Me]=i.useState(1);i.useEffect(()=>te.onProgress(u=>{u.queueSize===0&&(!u.inProgress||u.inProgress.length===0)&&(console.log("[JobsTab] Crawl completed, refreshing job list"),n())}),[n]),i.useEffect(()=>{if(!K.trim()){w();return}const o=setTimeout(()=>{f(K)},300);return()=>clearTimeout(o)},[K,f,w]);const mt=async o=>{if(k(o),v("page-content"),B(!0),o.jobId)try{const u=await te.getJob(o.jobId);A(u)}catch(u){console.error("Failed to fetch job:",u),A(null)}},ze=(o,u,S=150)=>{const j=o.toLowerCase(),F=u.toLowerCase(),I=j.indexOf(F);if(I===-1)return o.substring(0,S)+(o.length>S?"...":"");const G=Math.max(0,I-50),Z=Math.min(o.length,I+u.length+100),ae=o.substring(G,Z);return(G>0?"...":"")+ae+(Z<o.length?"...":"")},Ae=async o=>{try{if((await te.getCrawlStatus()).active){l({variant:"destructive",title:"Cannot resume",description:"There is already a capture in progress. Please wait for it to complete or cancel it first."});return}await te.startCrawl(o.baseUrl),l({variant:"success",title:"Capture resumed!",description:`Resuming capture for ${o.baseUrl}`}),me(),window.dispatchEvent(new CustomEvent("switch-tab",{detail:"crawl"}))}catch(u){console.error("Failed to resume crawl:",u),l({variant:"destructive",title:"Failed to resume",description:u instanceof Error?u.message:"Failed to start the capture"})}},ht=async o=>{try{await te.updateJob(o.id,{status:"completed"}),A({...o,status:"completed"}),n(),l({variant:"success",title:"Job marked as completed",description:`${o.baseUrl} has been marked as completed.`})}catch(u){console.error("Failed to mark job as completed:",u),l({variant:"destructive",title:"Failed to update job",description:u instanceof Error?u.message:"Failed to mark job as completed"})}},Ve=async o=>{A(o),v("job-details"),Y(""),J(!0);try{const u=await a(o.id);$(u)}catch(u){console.error("Failed to load pages:",u),l({variant:"destructive",title:"Failed to load pages",description:"Could not load the pages for this job"})}finally{J(!1)}},He=o=>{k(o),v("page-content")},Ze=()=>{m==="page-content"?pe?me():(v("job-details"),k(null)):m==="job-details"&&me()},me=()=>{v("closed"),A(null),k(null),$([]),Y(""),B(!1)},ke=Math.max(1,Math.ceil(t.length/re)),Ce=(H-1)*re,Fe=Math.min(Ce+re,t.length),b=i.useMemo(()=>t.slice(Ce,Fe),[t,Ce,Fe]);i.useEffect(()=>{H>ke&&Me(Math.max(1,ke))},[ke,H]);const y=b.length>0&&b.every(o=>x.has(o.id)),z=b.some(o=>x.has(o.id))&&!y;i.useEffect(()=>{const o=u=>{if(u.key==="Escape"){m!=="closed"?(u.preventDefault(),Ze()):x.size>0&&(u.preventDefault(),It());return}if(m==="closed"){if((u.ctrlKey||u.metaKey)&&u.key==="a"&&b.length>0){u.preventDefault(),X();return}if((u.key==="Delete"||u.key==="Backspace")&&x.size>0){u.preventDefault(),xt();return}}};return window.addEventListener("keydown",o),()=>window.removeEventListener("keydown",o)},[m,x,b]),i.useEffect(()=>{const o=u=>{const S=u.detail,j=t.find(F=>F.id===S);j&&Ve(j)};return window.addEventListener("open-job",o),()=>window.removeEventListener("open-job",o)},[t]);const V=i.useMemo(()=>{if(!U.trim())return p;const o=U.toLowerCase();return p.filter(u=>u.url.toLowerCase().includes(o))},[p,U]),X=()=>{const o=new Set(x);y?b.forEach(u=>o.delete(u.id)):b.forEach(u=>o.add(u.id)),M(o)},ft=(o,u,S)=>{S.stopPropagation();const j=new Set(x);if(S.shiftKey&&C!==null){const F=Math.min(C,u),I=Math.max(C,u);for(let G=F;G<=I;G++)j.add(b[G].id)}else j.has(o)?j.delete(o):j.add(o);M(j),_(u)},It=()=>{M(new Set),_(null)},xt=()=>{const o=t.filter(u=>x.has(u.id));W(o),v("delete-confirmation")},er=async()=>{const o=Array.from(x);try{await Promise.all(o.map(u=>r(u))),l({variant:"success",title:`${o.length} job${o.length>1?"s":""} deleted!`,description:"The selected jobs have been removed"}),It(),v("closed"),W([])}catch(u){console.error("Failed to delete jobs:",u),l({variant:"destructive",title:"Delete failed",description:"Failed to delete some jobs. Please try again."})}},tr=i.useMemo(()=>O.reduce((o,u)=>o+u.pagesProcessed,0),[O]),Ue=i.useMemo(()=>p.length===0?0:ot(p),[p]),Ot=async()=>{if(p.length!==0){if(!tt(p)){const o=(Ue/1048576).toFixed(1);l({variant:"destructive",title:"Content too large for clipboard",description:`Total size: ${o}MB. Please use download instead (max 10MB for clipboard).`});return}try{const o=Xt(p,R);await navigator.clipboard.writeText(o),l({variant:"success",title:"Copied to clipboard!",description:`${p.length} pages as markdown (${Oe(Ue)})`})}catch(o){console.error("Failed to copy to clipboard:",o),l({variant:"destructive",title:"Failed to copy",description:"Clipboard access denied or content too large"})}}},sr=async()=>{if(p.length!==0){if(!tt(p)){const o=(Ue/1048576).toFixed(1);l({variant:"destructive",title:"Content too large for clipboard",description:`Total size: ${o}MB. Please use download instead (max 10MB for clipboard).`});return}try{const o=we(p);await navigator.clipboard.writeText(o),l({variant:"success",title:"Copied to clipboard!",description:`${p.length} pages as raw text (${Oe(Ue)})`})}catch(o){console.error("Failed to copy to clipboard:",o),l({variant:"destructive",title:"Failed to copy",description:"Clipboard access denied or content too large"})}}},rr=()=>{if(p.length===0||!d)return;const o=we(p),u=new Blob([o],{type:"text/plain"}),S=URL.createObjectURL(u),j=document.createElement("a");j.href=S,j.download=`${st(d.baseUrl)}_all_pages.txt`,j.click(),URL.revokeObjectURL(S),l({variant:"success",title:"Download started!",description:`Downloading ${p.length} pages as single .txt file`})},ar=async()=>{if(!(p.length===0||!d)){l({title:"Preparing export...",description:"Creating ZIP archive with .txt files"});try{const o=new Xe;p.forEach(F=>{const I=et(F.url)+".txt",G=we([F]);o.file(I,G)});const u=await o.generateAsync({type:"blob",compression:"DEFLATE",compressionOptions:{level:6}}),S=URL.createObjectURL(u),j=document.createElement("a");j.href=S,j.download=`${st(d.baseUrl)}_all_pages_txt.zip`,j.click(),URL.revokeObjectURL(S),l({variant:"success",title:"Export complete!",description:`${p.length} .txt files downloaded as ZIP`})}catch(o){console.error("Failed to create ZIP:",o),l({variant:"destructive",title:"Export failed",description:"Failed to create ZIP archive. Please try again."})}}},qe=i.useMemo(()=>p.filter(u=>_t(u,.5)).length,[p]),or=()=>{if(p.length===0||!d)return;const o=.5,u=[];p.forEach(G=>{const Z=De(G,"markdown",o),ae=Z.fallback?`${"=".repeat(80)}
URL: ${G.url}
[Markdown unavailable: ${Z.reason}]
${"=".repeat(80)}

${Z.content}

`:Pe(G)+`
`;u.push(ae)});const S=u.join(`
`),j=new Blob([S],{type:"text/plain"}),F=URL.createObjectURL(j),I=document.createElement("a");I.href=F,I.download=`${st(d.baseUrl)}_all_pages.md`,I.click(),URL.revokeObjectURL(F),l({variant:"success",title:"Download started!",description:`Downloading ${qe}/${p.length} pages as markdown`})},nr=async()=>{if(!(p.length===0||!d)){l({title:"Preparing export...",description:"Creating ZIP archive with .md files"});try{const o=new Xe,u=.5;p.forEach(I=>{const G=et(I.url)+".md",Z=De(I,"markdown",u),ae=Z.fallback?`${"=".repeat(80)}
URL: ${I.url}
[Markdown unavailable: ${Z.reason}]
${"=".repeat(80)}

${Z.content}`:Pe(I);o.file(G,ae)});const S=await o.generateAsync({type:"blob",compression:"DEFLATE",compressionOptions:{level:6}}),j=URL.createObjectURL(S),F=document.createElement("a");F.href=j,F.download=`${st(d.baseUrl)}_all_pages_md.zip`,F.click(),URL.revokeObjectURL(j),l({variant:"success",title:"Export complete!",description:`${qe}/${p.length} pages as markdown in ZIP`})}catch(o){console.error("Failed to create ZIP:",o),l({variant:"destructive",title:"Export failed",description:"Failed to create ZIP archive. Please try again."})}}},Se=async()=>{const o=t.filter(S=>x.has(S.id)),u=[];for(const S of o)try{const j=await a(S.id);u.push(...j)}catch(j){console.error(`Failed to fetch pages for job ${S.id}:`,j)}return u},ir=async()=>{if(x.size!==0){l({title:"Preparing...",description:`Fetching pages from ${x.size} job${x.size>1?"s":""}`});try{const o=await Se();if(o.length===0){l({variant:"destructive",title:"No pages found",description:"Selected jobs have no pages to copy"});return}const u=ot(o);if(!tt(o)){const j=(u/1048576).toFixed(1);l({variant:"destructive",title:"Content too large for clipboard",description:`Total size: ${j}MB. Please use download instead (max 10MB for clipboard).`});return}const S=we(o);await navigator.clipboard.writeText(S),l({variant:"success",title:"Copied to clipboard!",description:`${o.length} pages as raw text (${Oe(u)})`})}catch(o){console.error("Failed to copy:",o),l({variant:"destructive",title:"Failed to copy",description:"Clipboard access denied or content too large"})}}},lr=async()=>{if(x.size!==0){l({title:"Preparing...",description:`Fetching pages from ${x.size} job${x.size>1?"s":""}`});try{const o=await Se();if(o.length===0){l({variant:"destructive",title:"No pages found",description:"Selected jobs have no pages to copy"});return}const u=ot(o);if(!tt(o)){const j=(u/1048576).toFixed(1);l({variant:"destructive",title:"Content too large for clipboard",description:`Total size: ${j}MB. Please use download instead (max 10MB for clipboard).`});return}const S=Xt(o,R);await navigator.clipboard.writeText(S),l({variant:"success",title:"Copied to clipboard!",description:`${o.length} pages as markdown (${Oe(u)})`})}catch(o){console.error("Failed to copy:",o),l({variant:"destructive",title:"Failed to copy",description:"Clipboard access denied or content too large"})}}},cr=async()=>{if(x.size!==0){l({title:"Preparing export...",description:`Fetching pages from ${x.size} job${x.size>1?"s":""}`});try{const o=await Se();if(o.length===0){l({variant:"destructive",title:"No pages found",description:"Selected jobs have no pages to export"});return}const u=new Xe;o.forEach(I=>{const G=et(I.url)+".txt",Z=we([I]);u.file(G,Z)});const S=await u.generateAsync({type:"blob",compression:"DEFLATE",compressionOptions:{level:6}}),j=URL.createObjectURL(S),F=document.createElement("a");F.href=j,F.download=`selected_jobs_${x.size}_all_pages_txt.zip`,F.click(),URL.revokeObjectURL(j),l({variant:"success",title:"Export complete!",description:`${o.length} .txt files from ${x.size} job${x.size>1?"s":""} downloaded as ZIP`})}catch(o){console.error("Failed to create ZIP:",o),l({variant:"destructive",title:"Export failed",description:"Failed to create ZIP archive. Please try again."})}}},dr=async()=>{if(x.size!==0){l({title:"Preparing export...",description:`Fetching pages from ${x.size} job${x.size>1?"s":""}`});try{const o=await Se();if(o.length===0){l({variant:"destructive",title:"No pages found",description:"Selected jobs have no pages to export"});return}const u=new Xe;o.forEach(I=>{const G=et(I.url)+".md",Z=De(I,"markdown",R),ae=Z.fallback?`${"=".repeat(80)}
URL: ${I.url}
[Markdown unavailable: ${Z.reason}]
${"=".repeat(80)}

${Z.content}`:Pe(I);u.file(G,ae)});const S=await u.generateAsync({type:"blob",compression:"DEFLATE",compressionOptions:{level:6}}),j=URL.createObjectURL(S),F=document.createElement("a");F.href=j,F.download=`selected_jobs_${x.size}_all_pages_md.zip`,F.click(),URL.revokeObjectURL(j),l({variant:"success",title:"Export complete!",description:`${o.length} .md files from ${x.size} job${x.size>1?"s":""} downloaded as ZIP`})}catch(o){console.error("Failed to create ZIP:",o),l({variant:"destructive",title:"Export failed",description:"Failed to create ZIP archive. Please try again."})}}},ur=async()=>{if(x.size!==0){l({title:"Preparing export...",description:`Fetching pages from ${x.size} job${x.size>1?"s":""}`});try{const o=await Se();if(o.length===0){l({variant:"destructive",title:"No pages found",description:"Selected jobs have no pages to export"});return}const u=we(o),S=new Blob([u],{type:"text/plain"}),j=URL.createObjectURL(S),F=document.createElement("a");F.href=j,F.download=`selected_jobs_${x.size}_all_pages.txt`,F.click(),URL.revokeObjectURL(j),l({variant:"success",title:"Download started!",description:`${o.length} pages from ${x.size} job${x.size>1?"s":""} as single .txt file`})}catch(o){console.error("Failed to export:",o),l({variant:"destructive",title:"Export failed",description:"Failed to create file. Please try again."})}}},pr=async()=>{if(x.size!==0){l({title:"Preparing export...",description:`Fetching pages from ${x.size} job${x.size>1?"s":""}`});try{const o=await Se();if(o.length===0){l({variant:"destructive",title:"No pages found",description:"Selected jobs have no pages to export"});return}const u=[];o.forEach(G=>{const Z=De(G,"markdown",R),ae=Z.fallback?`${"=".repeat(80)}
URL: ${G.url}
[Markdown unavailable: ${Z.reason}]
${"=".repeat(80)}

${Z.content}

`:Pe(G)+`
`;u.push(ae)});const S=u.join(`
`),j=new Blob([S],{type:"text/plain"}),F=URL.createObjectURL(j),I=document.createElement("a");I.href=F,I.download=`selected_jobs_${x.size}_all_pages.md`,I.click(),URL.revokeObjectURL(F),l({variant:"success",title:"Download started!",description:`${o.length} pages from ${x.size} job${x.size>1?"s":""} as single .md file`})}catch(o){console.error("Failed to export:",o),l({variant:"destructive",title:"Export failed",description:"Failed to create file. Please try again."})}}},mr=(o,u)=>{const S=t.find(j=>j.id===o)||d;ue(S),v("delete-single-job")},hr=async()=>{if(ee)try{await r(ee.id),l({variant:"success",title:"Job deleted!",description:"The job has been removed"}),v("closed"),ue(null),(d==null?void 0:d.id)===ee.id&&me()}catch(o){console.error("Failed to delete job:",o),l({variant:"destructive",title:"Delete failed",description:"Failed to delete the job. Please try again."})}},Dt=o=>o.status==="completed"?e.jsx(jt,{className:"h-4 w-4 text-green-500 shrink-0"}):o.status==="in_progress"?e.jsx(ie,{className:"h-4 w-4 text-blue-500 animate-spin shrink-0"}):o.status==="completed_with_errors"?e.jsx(nt,{className:"h-4 w-4 text-yellow-500 shrink-0"}):e.jsx(nt,{className:"h-4 w-4 text-red-500 shrink-0"}),Bt=o=>new Date(o).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}),fr=(o,u,S)=>{if(S&&S.length>1)return o.replace(/^https?:\/\//,"");const F=o.replace(/\/$/,""),I=u.replace(/\/$/,"");return F.replace(I,"").replace(/^\//,"")||"index"};if(s&&m==="closed")return e.jsx(le,{children:e.jsx(ce,{className:"pt-6",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ie,{className:"h-8 w-8 animate-spin mx-auto text-muted-foreground"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Loading jobs..."})]})})});if(t.length===0&&m==="closed")return e.jsxs(le,{children:[e.jsxs(it,{children:[e.jsx(lt,{className:"text-lg",children:"My Saved Sites"}),e.jsx(ct,{children:"Browse and manage your captured content"})]}),e.jsx(ce,{children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(xe,{className:"h-12 w-12 text-muted-foreground mx-auto mb-3"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"No saved content yet. Start capturing to get started."})]})})]});const xr=K.trim().length>0;return e.jsxs("div",{className:"flex flex-col h-full overflow-hidden",children:[e.jsxs("div",{className:"relative p-1 shrink-0",children:[e.jsx(Wt,{className:"absolute left-4 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(Ne,{type:"search",placeholder:"Search all pages by URL...",value:K,onChange:o=>de(o.target.value),className:"pl-9 pr-9"}),h&&e.jsx(ie,{className:"absolute right-4 top-1/2 -translate-y-1/2 h-4 w-4 animate-spin text-muted-foreground"})]}),xr?e.jsx("div",{className:"flex flex-col flex-1 overflow-hidden mt-4",children:c.length>0?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-sm text-muted-foreground shrink-0",children:["Found ",c.length," result",c.length!==1?"s":""]}),e.jsx("div",{className:"flex-1 overflow-auto pr-1 mt-3",children:e.jsx("div",{className:"space-y-2 pb-2",children:c.map(o=>e.jsx(le,{className:"cursor-pointer transition-colors hover:bg-accent/50",onClick:()=>mt(o),children:e.jsx(ce,{className:"p-3",children:e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("div",{className:"text-sm font-medium truncate",children:o.url}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[(o.contentLength/1024).toFixed(1)," KB"]}),e.jsx("div",{className:"text-xs text-muted-foreground bg-muted p-2 rounded break-words line-clamp-4",children:ze(o.content,K)})]})})},o.id))})})]}):h?null:e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsx(le,{className:"w-full",children:e.jsx(ce,{className:"pt-6",children:e.jsxs("div",{className:"text-center py-8",children:[e.jsx(xe,{className:"h-12 w-12 text-muted-foreground mx-auto mb-3"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:['No pages found with "',K,'" in URL']})]})})})})}):e.jsxs("div",{className:"flex flex-col flex-1 overflow-hidden mt-4",children:[e.jsxs("div",{className:"flex items-center gap-1 shrink-0 pb-2 border-b",children:[e.jsx(ve,{checked:y,ref:o=>{if(o){const u=o.querySelector("input")||o;"indeterminate"in u&&(u.indeterminate=z)}},onCheckedChange:X,"aria-label":"Select all jobs on this page",className:"ml-4 mr-1"}),x.size>0&&e.jsx(L,{size:"sm",variant:"ghost",onClick:xt,className:"h-8 w-8 p-0 text-destructive hover:text-destructive hover:bg-destructive/10",title:"Delete selected",children:e.jsx(Re,{className:"h-4 w-4"})}),x.size>0&&e.jsxs(Lt,{children:[e.jsx($t,{asChild:!0,children:e.jsx(L,{size:"sm",variant:"ghost",className:"h-8 w-8 p-0",children:e.jsx(yt,{className:"h-4 w-4"})})}),e.jsxs(ut,{align:"start",className:"w-[220px]",children:[e.jsx(ge,{className:"text-xs",children:"Copy to Clipboard"}),e.jsxs(q,{onClick:ir,children:[e.jsx(ne,{className:"h-4 w-4 mr-2"}),"Copy as raw text"]}),e.jsxs(q,{onClick:lr,children:[e.jsx(ne,{className:"h-4 w-4 mr-2"}),"Copy as markdown"]}),e.jsx(be,{}),e.jsx(ge,{className:"text-xs",children:"Download as ZIP"}),e.jsxs(q,{onClick:cr,children:[e.jsx(Qe,{className:"h-4 w-4 mr-2"}),"Zip using raw text files"]}),e.jsxs(q,{onClick:dr,children:[e.jsx(Qe,{className:"h-4 w-4 mr-2"}),"Zip using markdown files"]}),e.jsx(be,{}),e.jsx(ge,{className:"text-xs",children:"Download as Single File"}),e.jsxs(q,{onClick:ur,children:[e.jsx(xe,{className:"h-4 w-4 mr-2"}),"Single raw text file"]}),e.jsxs(q,{onClick:pr,children:[e.jsx(xe,{className:"h-4 w-4 mr-2"}),"Single markdown file"]}),e.jsx(be,{}),e.jsxs(q,{onClick:xt,className:"text-destructive focus:text-destructive",children:[e.jsx(Re,{className:"h-4 w-4 mr-2"}),"Delete"]})]})]}),x.size>0&&e.jsxs("span",{className:"text-sm text-muted-foreground ml-1",children:[x.size," selected"]}),e.jsx("div",{className:"flex-1"}),e.jsxs("div",{className:"flex items-center gap-0.5 text-sm text-muted-foreground",children:[e.jsxs("span",{className:"mr-2",children:[t.length===0?"0":`${Ce+1}-${Fe}`," of ",t.length]}),e.jsx(L,{size:"sm",variant:"ghost",className:"h-8 w-8 p-0",onClick:()=>Me(o=>o-1),disabled:H===1,children:e.jsx(Dr,{className:"h-4 w-4"})}),e.jsx(L,{size:"sm",variant:"ghost",className:"h-8 w-8 p-0",onClick:()=>Me(o=>o+1),disabled:H>=ke,children:e.jsx(Ee,{className:"h-4 w-4"})})]})]}),e.jsx("div",{className:"flex-1 overflow-auto pr-1 mt-3",children:e.jsx("div",{className:"space-y-2 pb-2",children:b.map((o,u)=>{const S=x.has(o.id);return e.jsx(le,{className:`cursor-pointer transition-all ${S?"border-primary bg-primary/5 ring-1 ring-primary/20":"hover:bg-accent/50"}`,onClick:()=>Ve(o),children:e.jsx(ce,{className:"p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(ve,{checked:S,onCheckedChange:()=>ft(o.id,u,{shiftKey:!1,stopPropagation:()=>{}}),onClick:j=>ft(o.id,u,j),"aria-label":`Select ${o.baseUrl}`,className:"mt-0.5"}),e.jsx("div",{className:"pt-0.5",children:Dt(o)}),e.jsxs("div",{className:"flex-1 min-w-0 space-y-1",children:[e.jsx("div",{className:"text-sm font-semibold truncate",children:o.baseUrl}),e.jsxs("div",{className:"text-xs text-muted-foreground flex items-center gap-2",children:[e.jsxs("span",{children:[o.pagesProcessed," pages"]}),e.jsx("span",{children:"â€¢"}),e.jsx("span",{children:Bt(o.createdAt)})]})]}),e.jsx(Ee,{className:"h-4 w-4 text-muted-foreground shrink-0 mt-1"})]})})},o.id)})})})]}),e.jsx(Ge,{open:m!=="closed",onOpenChange:o=>!o&&me(),children:e.jsxs(Le,{className:"p-0 max-w-[420px] gap-0 flex flex-col","aria-describedby":void 0,children:[e.jsxs("div",{className:"pl-4 pr-10 pt-3 pb-3 border-b flex items-center gap-2 shrink-0",children:[e.jsx(L,{size:"sm",variant:"ghost",onClick:Ze,className:"h-7 w-7 p-0 shrink-0",title:m==="page-content"?pe?"Back to search results":"Back to job details":"Back to jobs",children:e.jsx(zs,{className:"h-4 w-4"})}),e.jsx("div",{className:"flex-1 min-w-0 flex items-center gap-1 text-sm",children:m==="job-details"?e.jsxs("div",{className:"flex items-center gap-1 min-w-0 flex-1",children:[e.jsx(ye,{className:"truncate font-semibold min-w-0 flex-1",children:(d==null?void 0:d.baseUrl)||"Job Details"}),(d==null?void 0:d.baseUrl)&&e.jsx(L,{size:"sm",variant:"ghost",className:"h-6 w-6 p-0 shrink-0",title:"Copy URL",onClick:()=>{navigator.clipboard.writeText(d.baseUrl),l({variant:"success",title:"URL copied!"})},children:e.jsx(ne,{className:"h-3 w-3"})})]}):m==="page-content"?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:async()=>{if(B(!1),v("job-details"),k(null),d&&p.length===0){J(!0);try{const o=await a(d.id);$(o)}catch(o){console.error("Failed to load pages:",o),l({variant:"destructive",title:"Failed to load pages",description:"Could not load the pages for this job"})}finally{J(!1)}}},className:"text-sm text-muted-foreground hover:text-foreground hover:underline truncate max-w-[120px]",title:d==null?void 0:d.baseUrl,children:((Gt=d==null?void 0:d.baseUrl)==null?void 0:Gt.split("/")[2])||"Job"}),e.jsx(Ee,{className:"h-3 w-3 text-muted-foreground shrink-0"}),e.jsx(ye,{className:"truncate flex items-center gap-1",children:e.jsxs("button",{onClick:()=>(P==null?void 0:P.url)&&window.open(P.url,"_blank"),className:"text-sm hover:underline text-primary flex items-center gap-1 font-medium",title:P==null?void 0:P.url,children:[e.jsx($s,{className:"h-3 w-3 shrink-0"}),e.jsx("span",{className:"truncate max-w-[180px]",children:(P==null?void 0:P.url.split("/").pop())||"page"})]})})]}):e.jsx(ye,{className:"truncate font-semibold",children:"Loading..."})})]}),m==="job-details"&&d&&e.jsxs("div",{className:"flex flex-col flex-1 overflow-hidden",children:[e.jsxs("div",{className:"px-4 py-2.5 border-b flex items-center gap-2 shrink-0",children:[e.jsxs("div",{className:"relative flex-1 min-w-[140px]",children:[e.jsx(Wt,{className:"absolute left-2 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(Ne,{type:"search",placeholder:"Search pages...",value:U,onChange:o=>Y(o.target.value),className:"pl-8 h-9 text-sm"})]}),e.jsx(L,{size:"sm",variant:"ghost",onClick:Ot,disabled:T||p.length===0,className:"h-9 w-9 p-0 shrink-0",title:"Copy all as markdown","aria-label":"Copy all as markdown",children:e.jsx(ne,{className:"h-4 w-4"})}),e.jsxs(Lt,{children:[e.jsx($t,{asChild:!0,children:e.jsx(L,{size:"sm",variant:"ghost",className:"h-9 w-9 p-0 shrink-0",title:"More actions","aria-label":"More actions",children:e.jsx(yt,{className:"h-4 w-4"})})}),e.jsxs(ut,{align:"end",className:"w-[240px]",children:[(d.status!=="completed"||d.status==="interrupted")&&e.jsxs(e.Fragment,{children:[e.jsx(ge,{className:"text-xs",children:"Job Actions"}),d.status!=="completed"&&e.jsxs(q,{onClick:()=>ht(d),children:[e.jsx(jt,{className:"h-4 w-4 mr-2"}),"Mark as completed"]}),d.status==="interrupted"&&e.jsxs(q,{onClick:()=>Ae(d),children:[e.jsx(Br,{className:"h-4 w-4 mr-2"}),"Resume"]}),e.jsx(be,{})]}),e.jsx(ge,{className:"text-xs",children:"Copy to Clipboard"}),e.jsxs(q,{onClick:sr,disabled:T||p.length===0,children:[e.jsx(ne,{className:"h-4 w-4 mr-2"}),"Copy as raw text"]}),e.jsxs(q,{onClick:Ot,disabled:T||p.length===0,children:[e.jsx(ne,{className:"h-4 w-4 mr-2"}),"Copy as markdown"]}),e.jsx(be,{}),e.jsx(ge,{className:"text-xs",children:"Download as ZIP"}),e.jsxs(q,{onClick:ar,disabled:T||p.length===0,children:[e.jsx(Qe,{className:"h-4 w-4 mr-2"}),"Zip using raw text files"]}),e.jsxs(q,{onClick:nr,disabled:T||p.length===0||qe===0,children:[e.jsx(Qe,{className:"h-4 w-4 mr-2"}),"Zip using markdown files"]}),e.jsx(be,{}),e.jsx(ge,{className:"text-xs",children:"Download as Single File"}),e.jsxs(q,{onClick:rr,disabled:T||p.length===0,children:[e.jsx(xe,{className:"h-4 w-4 mr-2"}),"Single raw text file"]}),e.jsxs(q,{onClick:or,disabled:T||p.length===0||qe===0,children:[e.jsx(xe,{className:"h-4 w-4 mr-2"}),"Single markdown file"]}),e.jsx(be,{}),e.jsxs(q,{onClick:()=>mr(d.id),className:"text-destructive focus:text-destructive",children:[e.jsx(Re,{className:"h-4 w-4 mr-2"}),"Delete"]})]})]})]}),e.jsxs("div",{className:"px-4 pt-3 pb-2.5 bg-muted/30 border-b space-y-1 shrink-0",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[Dt(d),e.jsx("span",{className:"font-medium text-foreground capitalize",children:d.status.replace("_"," ")}),d.status==="interrupted"&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"-"}),e.jsx("button",{onClick:o=>{o.stopPropagation(),Ae(d)},className:"text-primary hover:text-primary/80 hover:underline font-medium transition-colors",children:"Resume"})]}),e.jsx("span",{children:"â€¢"}),e.jsxs("span",{children:[d.pagesProcessed," pages"]}),e.jsx("span",{children:"â€¢"}),e.jsx("span",{children:Oe(Ue)})]}),e.jsx("div",{className:"text-xs text-muted-foreground pl-6",children:Bt(d.createdAt)})]}),e.jsx("div",{className:"flex-1 overflow-hidden",children:T?e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx(ie,{className:"h-6 w-6 animate-spin text-muted-foreground"})}):V.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center p-4",children:[e.jsx(xe,{className:"h-10 w-10 text-muted-foreground mb-2"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:U?"No pages match your search":"No pages found"})]}):e.jsx(Ut,{className:"h-full",children:e.jsx("div",{className:"p-2 space-y-1",children:V.map(o=>e.jsx("button",{className:"w-full text-left px-3 py-2.5 text-xs hover:bg-accent rounded-md transition-colors group",onClick:()=>He(o),children:e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"truncate font-medium group-hover:text-primary",children:fr(o.url,d.baseUrl,d.baseUrls)}),e.jsxs("div",{className:"text-muted-foreground flex items-center gap-1.5",children:[e.jsxs("span",{children:[(o.contentLength/1024).toFixed(1)," KB"]}),o.alternateUrls&&o.alternateUrls.length>1&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"â€¢"}),e.jsxs("span",{className:"text-blue-500",title:`Found under ${o.alternateUrls.length} URLs`,children:[o.alternateUrls.length," URLs"]})]})]})]}),e.jsx(Ee,{className:"h-4 w-4 text-muted-foreground shrink-0 opacity-0 group-hover:opacity-100 transition-opacity"})]})},o.id))})})})]}),m==="page-content"&&P&&e.jsx(to,{page:P,confidenceThreshold:R,defaultFormat:g})]})}),e.jsx(Ge,{open:m==="delete-single-job",onOpenChange:o=>!o&&v("closed"),children:e.jsxs(Le,{centered:!0,className:"max-w-[340px] sm:max-w-[380px]",children:[e.jsxs(ye,{className:"flex items-center gap-2 text-base",children:[e.jsx(Re,{className:"h-5 w-5 text-destructive"}),"Delete job?"]}),e.jsx(dt,{asChild:!0,children:e.jsxs("div",{className:"space-y-3 pt-2",children:[ee&&e.jsxs("div",{className:"bg-muted/50 p-3 rounded-md",children:[e.jsx("div",{className:"text-sm font-medium truncate",children:ee.baseUrl}),e.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:[ee.pagesProcessed," pages"]})]}),e.jsx("p",{className:"text-sm text-destructive",children:"This action cannot be undone."})]})}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(L,{variant:"outline",onClick:()=>{v("closed"),ue(null)},children:"Cancel"}),e.jsx(L,{variant:"destructive",onClick:hr,children:"Delete Job"})]})]})}),e.jsx(Ge,{open:m==="delete-confirmation",onOpenChange:o=>!o&&v("closed"),children:e.jsxs(Le,{centered:!0,className:"max-w-[340px] sm:max-w-[380px]",children:[e.jsxs(ye,{className:"flex items-center gap-2 text-base",children:[e.jsx(Re,{className:"h-5 w-5 text-destructive"}),"Delete ",O.length," job",O.length>1?"s":"","?"]}),e.jsx(dt,{asChild:!0,children:e.jsxs("div",{className:"space-y-3 pt-2",children:[e.jsxs("p",{className:"text-sm text-muted-foreground",children:["This will delete ",e.jsxs("strong",{children:[tr," pages"]})," total."]}),e.jsx("p",{className:"text-sm text-destructive",children:"This action cannot be undone."})]})}),e.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[e.jsx(L,{variant:"outline",onClick:()=>v("closed"),children:"Cancel"}),e.jsx(L,{variant:"destructive",onClick:er,children:"Delete Jobs"})]})]})})]})}const ro=$r,Zs=i.forwardRef(({className:t,...s},r)=>e.jsx(Ns,{ref:r,className:N("fixed bottom-0 z-[100] flex max-h-screen w-full flex-col p-4",t),...s}));Zs.displayName=Ns.displayName;const ao=Je("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-bottom-full data-[state=open]:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground",success:"border-green-500 bg-green-500 text-white",warning:"border-orange-500 bg-orange-500 text-white"}},defaultVariants:{variant:"default"}}),qs=i.forwardRef(({className:t,variant:s,...r},a)=>e.jsx(ks,{ref:a,className:N(ao({variant:s}),t),...r}));qs.displayName=ks.displayName;const oo=i.forwardRef(({className:t,...s},r)=>e.jsx(Cs,{ref:r,className:N("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",t),...s}));oo.displayName=Cs.displayName;const Ks=i.forwardRef(({className:t,...s},r)=>e.jsx(Ss,{ref:r,className:N("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",t),"toast-close":"",...s,children:e.jsx(Mt,{className:"h-4 w-4"})}));Ks.displayName=Ss.displayName;const Qs=i.forwardRef(({className:t,...s},r)=>e.jsx(Rs,{ref:r,className:N("text-sm font-semibold",t),...s}));Qs.displayName=Rs.displayName;const Xs=i.forwardRef(({className:t,...s},r)=>e.jsx(Es,{ref:r,className:N("text-sm opacity-90",t),...s}));Xs.displayName=Es.displayName;function no(){const{toasts:t}=We();return e.jsxs(ro,{children:[t.map(function({id:s,title:r,description:a,action:n,...c}){return e.jsxs(qs,{duration:2e3,...c,children:[e.jsxs("div",{className:"grid gap-1",children:[r&&e.jsx(Qs,{children:r}),a&&e.jsx(Xs,{children:a})]}),n,e.jsx(Ks,{})]},s)}),e.jsx(Zs,{})]})}const io="4.1.0.260126.9266cc8",Yt={capture:"bg-blue-500/10 text-blue-500 border-blue-500/20","tab-fetcher":"bg-purple-500/10 text-purple-500 border-purple-500/20",popup:"bg-green-500/10 text-green-500 border-green-500/20","service-worker":"bg-orange-500/10 text-orange-500 border-orange-500/20",unknown:"bg-gray-500/10 text-gray-500 border-gray-500/20"},lo=[{value:"all",label:"All time"},{value:"today",label:"Today"},{value:"week",label:"This week"},{value:"month",label:"This month"}];function co({open:t,onBack:s}){const[r,a]=i.useState([]),[n,c]=i.useState(!0),[h,f]=i.useState(new Set),[w,l]=i.useState("all"),[m,v]=i.useState("all"),{toast:d}=We();i.useEffect(()=>{t&&A()},[t]);const A=async()=>{c(!0);try{const g=await Zt.getErrorLogs();a(g)}catch(g){console.error("Failed to fetch error logs:",g),d({title:"Failed to load errors",description:"Could not fetch error logs",variant:"destructive"})}finally{c(!1)}},P=i.useMemo(()=>{const g=new Set(r.map(R=>R.source));return Array.from(g).sort()},[r]),k=i.useMemo(()=>{let g=r;if(w!=="all"&&(g=g.filter(R=>R.source===w)),m!=="all"){const R=Date.now(),x=24*60*60*1e3;let M;switch(m){case"today":M=R-x;break;case"week":M=R-7*x;break;case"month":M=R-30*x;break;default:M=0}g=g.filter(C=>C.timestamp>M)}return g},[r,w,m]),p=g=>{f(R=>{const x=new Set(R);return x.has(g)?x.delete(g):x.add(g),x})},$=g=>{const R=Date.now()-g,x=Math.floor(R/6e4),M=Math.floor(R/36e5),C=Math.floor(R/864e5);return x<1?"Just now":x<60?`${x}m ago`:M<24?`${M}h ago`:C<7?`${C}d ago`:new Date(g).toLocaleDateString()},T=g=>new Date(g).toLocaleString(),J=async g=>{var x,M,C;const R={reportGenerated:new Date().toISOString(),reportVersion:"1.0",filters:{source:w,date:m,totalErrors:r.length,filteredErrors:k.length},extension:{version:typeof chrome<"u"&&chrome.runtime&&((C=(M=(x=chrome.runtime).getManifest)==null?void 0:M.call(x))==null?void 0:C.version)||"unknown"},browser:{userAgent:navigator.userAgent,platform:navigator.platform},errorLogs:k.map(_=>({id:_.id,timestamp:new Date(_.timestamp).toISOString(),source:_.source,message:_.message,stack:_.stack,context:_.context}))};if(g==="string"){let _=`# Webscribe Diagnostic Report
`;_+=`Generated: ${R.reportGenerated}
`,_+=`Showing: ${R.filters.filteredErrors} of ${R.filters.totalErrors} errors
`,w!=="all"&&(_+=`Source filter: ${w}
`),m!=="all"&&(_+=`Date filter: ${m}
`),_+=`
## Browser Info
`,_+=`- User Agent: ${R.browser.userAgent}
`,_+=`- Platform: ${R.browser.platform}

`,_+=`## Error Logs

`;for(const O of R.errorLogs)_+=`### ${O.timestamp} [${O.source}]
`,_+=`**Message:** ${O.message}
`,O.context&&Object.keys(O.context).length>0&&(_+=`**Context:** ${JSON.stringify(O.context,null,2)}
`),O.stack&&(_+=`**Stack Trace:**
\`\`\`
${O.stack}
\`\`\`
`),_+=`
---

`;return _}return R},U=async()=>{try{const g=await J("string");await navigator.clipboard.writeText(g),d({title:"Copied to clipboard",description:`${k.length} error(s) copied`})}catch(g){console.error("Failed to copy:",g),d({title:"Copy failed",description:"Could not copy to clipboard",variant:"destructive"})}},Y=async()=>{try{const g=await J("json"),R=new Blob([JSON.stringify(g,null,2)],{type:"application/json"}),x=URL.createObjectURL(R),M=document.createElement("a");M.href=x,M.download=`error-report-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(M),M.click(),document.body.removeChild(M),URL.revokeObjectURL(x),d({title:"Report downloaded",description:`${k.length} error(s) exported`})}catch(g){console.error("Failed to download:",g),d({title:"Download failed",description:"Could not generate report",variant:"destructive"})}},K=async()=>{if(confirm("Are you sure you want to clear all error logs? This cannot be undone."))try{await Zt.clearErrorLogs(),a([]),f(new Set),d({title:"Logs cleared",description:"All error logs have been deleted"})}catch(g){console.error("Failed to clear logs:",g),d({title:"Clear failed",description:"Could not clear error logs",variant:"destructive"})}},de=async(g,R)=>{R.stopPropagation();try{const x=[`Timestamp: ${T(g.timestamp)}`,`Source: ${g.source}`,`Message: ${g.message}`,g.context?`Context: ${JSON.stringify(g.context,null,2)}`:null,g.stack?`Stack Trace:
${g.stack}`:null].filter(Boolean).join(`

`);await navigator.clipboard.writeText(x),d({title:"Error copied",description:"Error details copied to clipboard"})}catch{d({title:"Copy failed",variant:"destructive"})}};return e.jsxs("div",{className:N("absolute inset-0 bg-background z-50 flex flex-col transition-transform duration-300 ease-in-out",t?"translate-x-0":"translate-x-full"),children:[e.jsxs("div",{className:"flex items-center gap-2 p-4 border-b border-border",children:[e.jsx(L,{variant:"ghost",size:"icon",onClick:s,className:"h-8 w-8",children:e.jsx(zs,{className:"h-4 w-4"})}),e.jsx("h2",{className:"font-semibold flex-1",children:"Error Logs"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:k.length===r.length?`${r.length} error${r.length===1?"":"s"}`:`${k.length} of ${r.length}`})]}),e.jsxs("div",{className:"flex items-center gap-2 p-3 border-b border-border bg-muted/30",children:[e.jsxs("select",{value:w,onChange:g=>l(g.target.value),className:"text-sm bg-background border border-border rounded px-2 py-1",children:[e.jsx("option",{value:"all",children:"All sources"}),P.map(g=>e.jsx("option",{value:g,children:g},g))]}),e.jsx("select",{value:m,onChange:g=>v(g.target.value),className:"text-sm bg-background border border-border rounded px-2 py-1",children:lo.map(({value:g,label:R})=>e.jsx("option",{value:g,children:R},g))}),e.jsx("div",{className:"flex-1"}),e.jsx(L,{variant:"ghost",size:"icon",onClick:U,disabled:k.length===0,className:"h-7 w-7",title:"Copy to clipboard",children:e.jsx(ne,{className:"h-3.5 w-3.5"})}),e.jsx(L,{variant:"ghost",size:"icon",onClick:Y,disabled:k.length===0,className:"h-7 w-7",title:"Download as JSON",children:e.jsx(Ms,{className:"h-3.5 w-3.5"})}),r.length>0&&e.jsx(L,{variant:"ghost",size:"sm",onClick:K,className:"h-7 px-2 text-muted-foreground hover:text-destructive",children:e.jsx(Re,{className:"h-3.5 w-3.5"})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:n?e.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground",children:"Loading..."}):k.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-muted-foreground gap-2",children:[e.jsx(jt,{className:"h-8 w-8 text-green-500/50"}),e.jsx("p",{className:"text-sm",children:r.length===0?"No errors recorded in the last 30 days":"No errors match the current filters"})]}):e.jsx("div",{className:"divide-y divide-border",children:k.map((g,R)=>e.jsxs("div",{className:N("cursor-pointer hover:bg-muted/50 transition-colors",R%2===0?"bg-background":"bg-muted/20"),children:[e.jsxs("div",{className:"flex items-center gap-2 p-3",onClick:()=>p(g.id),children:[h.has(g.id)?e.jsx(zt,{className:"h-4 w-4 text-muted-foreground flex-shrink-0"}):e.jsx(Ee,{className:"h-4 w-4 text-muted-foreground flex-shrink-0"}),e.jsx("span",{className:"text-xs text-muted-foreground w-16 flex-shrink-0",title:T(g.timestamp),children:$(g.timestamp)}),e.jsx(Ws,{variant:"outline",className:N("text-xs px-1.5 py-0 flex-shrink-0",Yt[g.source]||Yt.unknown),children:g.source}),e.jsx("span",{className:"text-sm truncate flex-1",children:g.message})]}),h.has(g.id)&&e.jsxs("div",{className:"px-3 pb-3 pl-9 space-y-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-muted-foreground mb-1",children:"Full Message"}),e.jsx("div",{className:"text-sm bg-muted/50 p-2 rounded break-all",children:g.message})]}),g.context&&Object.keys(g.context).length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-muted-foreground mb-1",children:"Context"}),e.jsx("div",{className:"text-xs bg-muted/50 p-2 rounded font-mono",children:Object.entries(g.context).map(([x,M])=>e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("span",{className:"text-muted-foreground",children:[x,":"]}),e.jsx("span",{className:"break-all",children:typeof M=="object"?JSON.stringify(M):String(M)})]},x))})]}),g.stack&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-muted-foreground mb-1",children:"Stack Trace"}),e.jsx("div",{className:"text-xs bg-muted/50 p-2 rounded font-mono overflow-x-auto max-h-32 overflow-y-auto whitespace-pre",children:g.stack})]}),e.jsxs(L,{variant:"outline",size:"sm",className:"h-7",onClick:x=>de(g,x),children:[e.jsx(ne,{className:"h-3 w-3 mr-1"}),"Copy this error"]})]})]},g.id))})})]})}function je({icon:t,title:s,description:r,onClick:a}){return e.jsxs("button",{onClick:a,className:N("w-full flex items-start gap-4 p-4 rounded-lg border border-border","hover:bg-accent hover:border-accent-foreground/20","transition-colors text-left"),children:[e.jsx("div",{className:"p-3 rounded-full bg-muted",children:e.jsx(t,{className:"h-5 w-5"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-medium",children:s}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:r})]})]})}function uo({open:t,onOpenChange:s}){const[r,a]=i.useState(!1),n=()=>{window.open("https://bobninja.com/tools/webscribe/guide/","_blank")},c=()=>{window.open("https://bobninja.com/tools/webscribe/","_blank")},h=()=>{window.open("https://github.com/storyleaps/bobninja-webscribe/issues","_blank")},f=()=>{window.open("https://github.com/storyleaps/bobninja-webscribe","_blank")},w=()=>{window.open("https://github.com/storyleaps/bobninja-webscribe/discussions","_blank")},l=()=>{a(!0)},m=()=>{window.open("https://bobninja.com/tools/webscribe/privacy/","_blank")},v=()=>{a(!1)},d=A=>{A||a(!1),s(A)};return e.jsx(Ge,{open:t,onOpenChange:d,children:e.jsxs(Le,{className:"w-[400px] h-[600px] max-w-none p-0 overflow-hidden",centered:!0,"aria-describedby":void 0,children:[e.jsx(ye,{className:"sr-only",children:"About Webscribe"}),e.jsxs("div",{className:N("flex flex-col h-full p-6 transition-transform duration-300 ease-in-out",r?"-translate-x-full":"translate-x-0"),children:[e.jsxs("div",{className:"flex-1 overflow-auto pr-1 space-y-3 pb-2",children:[e.jsx(je,{icon:Gr,title:"How-to Guide",description:"Learn how to use Webscribe",onClick:n}),e.jsx(je,{icon:Ls,title:"Website",description:"Visit the Webscribe homepage",onClick:c}),e.jsx(je,{icon:Wr,title:"Report Bugs",description:"Report issues on GitHub",onClick:h}),e.jsx(je,{icon:Jr,title:"GitHub",description:"View source code and contribute",onClick:f}),e.jsx(je,{icon:Vr,title:"Discussions",description:"Ask questions, share ideas, get help",onClick:w}),e.jsxs("div",{className:"pt-3 border-t border-border",children:[e.jsx(je,{icon:Hr,title:"Diagnostics",description:"View error logs and generate reports",onClick:l}),e.jsx("div",{className:"mt-3",children:e.jsx(je,{icon:Zr,title:"Privacy Policy",description:"See how your data is protected",onClick:m})})]})]}),e.jsxs("div",{className:"mt-8 text-center text-sm text-muted-foreground",children:["Webscribe â€” Version ",io]})]}),e.jsx(co,{open:r,onBack:v})]})})}function po(){const[t,s]=i.useState("crawl"),[r,a]=i.useState(!1);return i.useEffect(()=>{const n=c=>{s(c.detail)};return window.addEventListener("switch-tab",n),()=>window.removeEventListener("switch-tab",n)},[]),e.jsxs("div",{className:"w-[400px] h-[600px] bg-background text-foreground flex flex-col",children:[e.jsxs("div",{className:"p-4 flex flex-col h-full overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h1",{className:"text-xl font-bold",children:"Webscribe"}),e.jsx(L,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>a(!0),children:e.jsx(yt,{className:"h-4 w-4"})})]}),e.jsxs(Ea,{value:t,onValueChange:s,className:"w-full flex-1 flex flex-col overflow-hidden",children:[e.jsxs(Bs,{className:"grid w-full grid-cols-2 flex-shrink-0",children:[e.jsx(Ct,{value:"crawl",children:"Capture"}),e.jsx(Ct,{value:"jobs",children:"Jobs"})]}),e.jsx(St,{value:"crawl",className:"flex-1 overflow-hidden m-0 mt-4",children:e.jsx(Ga,{})}),e.jsx(St,{value:"jobs",className:"flex-1 overflow-hidden m-0 mt-4",children:e.jsx(so,{})})]})]}),e.jsx(no,{}),e.jsx(uo,{open:r,onOpenChange:a})]})}class mo extends i.Component{constructor(){super(...arguments);Ke(this,"state",{hasError:!1,error:null});Ke(this,"handleReload",()=>{window.location.reload()});Ke(this,"handleReset",()=>{this.setState({hasError:!1,error:null})})}static getDerivedStateFromError(r){return{hasError:!0,error:r}}componentDidCatch(r,a){console.error("[ErrorBoundary] Uncaught error:",r,a),this.logErrorToServiceWorker(r,a)}async logErrorToServiceWorker(r,a){try{if(navigator.serviceWorker.controller){const n=new MessageChannel;navigator.serviceWorker.controller.postMessage({type:"LOG_ERROR",data:{source:"popup",message:r.message,stack:r.stack,context:{componentStack:a.componentStack,type:"react-error-boundary"}}},[n.port2])}}catch(n){console.error("[ErrorBoundary] Failed to log error to service worker:",n)}}render(){return this.state.hasError?e.jsx("div",{className:"w-[400px] h-[600px] bg-background text-foreground flex flex-col items-center justify-center p-6",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("div",{className:"p-4 rounded-full bg-destructive/10 inline-block",children:e.jsx(nt,{className:"h-8 w-8 text-destructive"})}),e.jsx("h2",{className:"text-lg font-semibold",children:"Something went wrong"}),e.jsx("p",{className:"text-sm text-muted-foreground max-w-[300px]",children:"An unexpected error occurred. The error has been logged for diagnostic purposes."}),this.state.error&&e.jsx("div",{className:"mt-4 p-3 bg-muted rounded-lg text-left",children:e.jsx("p",{className:"text-xs font-mono text-muted-foreground break-all",children:this.state.error.message})}),e.jsxs("div",{className:"flex gap-2 justify-center mt-6",children:[e.jsx(L,{variant:"outline",onClick:this.handleReset,children:"Try Again"}),e.jsxs(L,{onClick:this.handleReload,children:[e.jsx(qr,{className:"h-4 w-4 mr-2"}),"Reload"]})]})]})}):this.props.children}}function Ys(t,s,r={}){try{if(navigator.serviceWorker.controller){const a=new MessageChannel;navigator.serviceWorker.controller.postMessage({type:"LOG_ERROR",data:{source:t,message:s instanceof Error?s.message:String(s),stack:s instanceof Error?s.stack:null,context:r}},[a.port2])}}catch(a){console.error("[Popup] Failed to log error to service worker:",a)}}window.addEventListener("error",t=>{console.error("[Popup] Uncaught error:",t.error),Ys("popup",t.error||t.message,{filename:t.filename,lineno:t.lineno,colno:t.colno,type:"uncaught-error"})});window.addEventListener("unhandledrejection",t=>{console.error("[Popup] Unhandled promise rejection:",t.reason),Ys("popup",t.reason,{type:"unhandled-rejection"})});Nt.createRoot(document.getElementById("root")).render(e.jsx(zr.StrictMode,{children:e.jsx(mo,{children:e.jsx(po,{})})}));
